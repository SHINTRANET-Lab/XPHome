<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=LTR><head><title>リダイレクト リファレンス</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="リダイレクトについて説明します。">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=shift_jis">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="JA">
<META NAME="MS-IT-LOC" Content="インターネット インフォメーション サービス">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="ＭＳ Ｐゴシック">

<h1><A NAME="H1_448393581">リダイレクト リファレンス</A></h1>

<p>クライアントの要求をリダイレクトすると、サイトが作成中である場合やサイトが移動した場合に、ユーザーを正しいページに案内することができます。クライアントの要求は、IIS を実行しているサーバー上のディレクトリ、別のコンピュータ上の UNC の共有ディレクトリ、または別の URL にリダイレクトできます。 </p>

<h2><a name="redir1">リダイレクトの変数</a></h2>

<p>リダイレクトの変数は、元の URL の一部をリダイレクト先の URL に渡すときに使用できます。これらの変数を使用するには、<a href="iiabuti.htm">IIS スナップイン</a>でディレクトリのプロパティ シートを開いて、[ホーム ディレクトリ]、[仮想ディレクトリ]、または [ディレクトリ] プロパティ シートを選択します。</p>

<table width="100%" border="1" cellspacing="0" cellpadding="2">

<tr>
<th bgcolor="#C0C0C0" align="Left" valign="top">変数</th>
<th align="CENTER" valign="TOP" bgcolor="#C0C0C0">説明</th>
<th align="CENTER" valign="TOP" bgcolor="#C0C0C0">例</th>
</tr>

<tr>
<td valign="top"><strong>$S</strong></td>
<td valign="top">要求された URL において一致するサフィックスを渡します。一致するサフィックスとは、リダイレクト先の URL に置き換わった後もそのまま残る部分です。</td>
<td valign="top">/scripts を /newscripts にリダイレクトしている場合、元の要求が /scripts/program.exe であれば、/program.exe がサフィックスになります。このサフィックスの置き換えはサーバーによって自動的に行われるので、$S 変数は、ほかの変数と組み合わせる場合にのみ使用します。</td>
</tr>

<tr>
<td valign="top"><strong>$P</strong></td>
<td valign="top">元の URL のパラメータを渡します。 </td>
<td valign="top">たとえば、元の URL が /scripts/myscript.asp?number=1 である場合は、&quot;number=1&quot; という文字列がリダイレクト先の URL の中で置き換えられます。</td>
</tr>

<tr>
<td valign="top"><strong>$Q</strong></td>
<td valign="top">元の URL の疑問符 (?) とパラメータの両方を渡します。</td>
<td valign="top">たとえば、元の URL が /scripts/myscript.asp?number=1 である場合は、&quot;?number=1&quot; という文字列がリダイレクト先の URL の中で置き換えられます。</td>
</tr>

<tr>
<td valign="top"><strong>$V</strong></td>
<td valign="top">要求された URL をサーバー名を除いて渡します。</td>
<td valign="top">たとえば、元の URL が //myserver/scripts/myscript.asp である場合は、&quot;/scripts/myscript.asp&quot; という文字列がリダイレクト先の URL の中で置き換えられます。</td>
</tr>

<tr>
<td valign="top"><strong>$0</strong> から <strong>$9</strong></td>
<td valign="top">要求された URL の中で、指定されたワイルドカードに一致する部分を渡します。</td>
<td valign="top">たとえば、*/default.htm などの最下位ディレクトリの名前にワイルドカードが使用された場合は、Default.htm を含むそのディレクトリに相当する URL の一部が渡されます。</td>
</tr>

<tr>
<td valign="top"><strong>!</strong></td>
<td valign="top">リダイレクトを行いません。 </td>
<td valign="top">この変数は、リダイレクトされた仮想ディレクトリのサブディレクトリまたは個々のファイルをリダイレクトしない場合に使用します。</td>
</tr>

</table>

<h2><a name="redir2">リダイレクトのワイルドカード</a></h2>

<p>リダイレクトのワイルドカードは、元の URL の中の任意の数の文字列を一致させるときに使用します。ワイルドカード文字 (*) は、ディレクトリの [ホーム ディレクトリ]、[仮想ディレクトリ]、または [ディレクトリ] プロパティ シートの [リダイレクト先] ボックスに直接入力します。リダイレクト先の URL の先頭にはアスタリスク (*) とセミコロン (;) を入力します。ワイルドカードとリダイレクト先の URL の組み合わせは、セミコロン (;) で区切ります。</p>

<p>たとえば、/scripts 内のすべての .stm ファイルへの要求を Default.stm という 1 つのファイルにリダイレクトし、/scripts 内のすべての .htm ファイルへの要求を Default.htm という 1 つのファイルにリダイレクトするには、/scripts 仮想ディレクトリの [リダイレクト先] ボックスに次のように入力します。</p>

<blockquote><strong>*;*.stm;/default.stm;*.htm;/default.htm</strong></blockquote>

<p>ワイルドカードを使用するときは、[上で入力した URL] チェック ボックスを必ずオンにします。リダイレクト先のパスには、URL を入力してください。</p>

<p><strong>関連項目</strong></p>

<ul>
<li><p>リダイレクトについては、「<a href="iihtmat.htm">Web サイト管理について</a>」の「<a href="iihtmat.htm#browserredirects">リダイレクトによるリルート要求</a>」を参照してください。</li>
<li>リダイレクトの手順については、「<a href="iicodirr.htm">要求をディレクトリにリダイレクトする</a>」または「<a href="iicodirp.htm">要求をプログラムにリダイレクトする</a>」を参照してください。</li>

</ul>


<hr class="iis" size="1"><p align=center><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation.All rights reserved.</a></em></p>

<script language="javascript">
<!--
function Activate() {
if (navigator.appName == "Microsoft Internet Explorer"){
	window.open("iisnapin.htm", "NewWin", 'toolbar=no, left=200, top=200, scrollbars=no, resizeable=no,  width=350, height=350');
	}
	else if (navigator.appName == "Netscape") {
		window.open("iisnapin.htm", "NewWin",  'toolbar=0,location=0,directories=0,status=0,menubar=0,scrollbars=yes,resizable=0,width=350,height=350,top=200,left=200');
	}
}
//-->
</script>

</font>
</body>
</html>
