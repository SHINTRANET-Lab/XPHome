<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=LTR><head><title>ユーザー アカウントにクライアント証明書をマップする</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="description" CONTENT="クライアント証明書を提示してログオンするユーザーの認証に関して、その概念と方法を説明します。Windows ユーザー アカウントに、証明書の情報をマップする方法について説明します。">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=shift_jis">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="JA">
<META NAME="MS-IT-LOC" Content="インターネット インフォメーション サービス">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="ＭＳ Ｐゴシック">

<h1><a name="H1_37709492">ユーザー アカウントにクライアント証明書をマップする</a></h1>

<p>&quot;マッピング&quot;を作成することで、クライアント証明書を使ってログオンするユーザーを認証できます。マッピングは、証明書に含まれる情報と Windows のユーザー アカウントを関連付けます。証明書をマップする方法には、<a href="#H2_448402558">一対一</a>と<a href="#H2_448402922">多対一</a>の 2 つがあります。いずれのマッピングにも、<a href="iiabuti.htm">IIS スナップイン</a>を使用できます。</P>

<ul>
<li><a href="#aboutmap">マッピングについて</a></li>
<li><a href="#mappingstratagies">マッピング方法</a></li>
<li><a href="#exportingmap">証明書をエクスポートする</a></li>
<li><a href="#mapping">証明書をマップする手順</a></li>
</ul>

<P><strong><font color="#0000FF">重要</font></strong></p>
<ul>
<li>証明書をマップするには、事前にサーバー証明書をインストールする必要があります。サーバー証明書のインストールの詳細については、「<A HREF="iiocrsc.htm">サーバー証明書を取得する</A>」を参照してください。</li>
<li>マッピング規則の変更を有効にするには、Web サイトを停止して再起動する必要があります。そのためには、<a href="iiabuti.htm">IIS スナップイン</a>で Web サイトを選択し、[操作] メニューの [停止] をクリックするか、またはツール バーの [停止] をクリックします。次に、[操作] メニューの [開始] をクリックするか、またはツール バーの [開始] をクリックします。</li>
</ul>

<p class="bigfix">&nbsp;</p>



<H2><A NAME="aboutmap"></A>マッピングについて</H2>

<H3><A NAME="H2_448402558"></A>一対一マッピング</H3>
<P>一対一マッピングでは、個別のクライアント証明書をアカウントにマップします。サーバーは、ブラウザから送信されたクライアント証明書を、保持しているクライアント証明書のコピーと比較します。この 2 つが完全に一致していない場合は、マップできません。クライアントが、まったく同じユーザー情報を含む別の証明書を取得した場合は、その証明書を再度マップする必要があります。</P>

<H3><A NAME="H2_448402922"></A>多対一マッピング</H3>
<P>多対一マッピングでは、&quot;ワイルドカード&quot; による一致規則を使って、クライアント証明書に、発行者やサブジェクトなどの特定情報が含まれているかどうかを検査します。このマッピングでは、実際のクライアント証明書を比較するのではなく、特定の条件を満たすクライアント証明書をすべて受け付けます。クライアントが、まったく同じユーザー情報を含む別の証明書を取得した場合でも、既存のマッピングで対応できます。</P>

<H3>ディレクトリ サービス (DS) マッピング</H3>
<P>ディレクトリ サービス (DS) による証明書マッピングでは、Windows Active Directory 機能を使って、クライアント証明書を持つユーザーを認証します。DS マッピングには、利点と欠点があります。たとえば、クライアント証明書の情報を多数のサーバーで共有できることは利点ですが、ワイルドカードによる比較が IIS マッパーほど高度ではないことは欠点です。DS マッピングの詳細については、Windows のマニュアルを参照してください。</p>
<p>DS マッピングを有効にできるのは、プロパティ レベルが Master であり、Windows ドメインのメンバであるユーザーだけです。DS マッピングを有効にすると、Web サービス全体で<nobr loc>一対一</nobr loc>および<nobr loc>多対一</nobr loc>のマッピングを使用できなくなります。</P>


<a name="mappingstratagies"></a><H2><A NAME="H2_448403756"></A>マッピング方法</H2>
<P>クライアント証明書マッピングは、3 つの方法のいずれかを使用して、クライアント証明書をユーザー アカウントにマップできるという高い柔軟性を持っています。1 つのクライアント証明書を任意数のユーザー アカウントにマップすることも、任意数のクライアント証明書を単一のユーザー アカウントにマップすることも可能です。証明書マッピングは、次のようないくつかの状況で使用できます。</P>

<UL>
<LI><strong>大規模ネットワーク</strong>&nbsp;  クライアント証明書が多数あり、多対一マッピングや DS マッピングを使用するネットワーク。管理者は、1 つまたは複数の一致規則を作成して、1 つまたは複数の Windows ユーザー アカウントに証明書をマップすることができます。</LI>

<LI><strong>小規模ネットワーク</strong>&nbsp;  ユーザーはごく少数で、一対一マッピングを使って証明書の利用状況と無効化を詳細に管理しているか、または多対一マッピングを使って管理を簡素化しているネットワーク。</LI>

<LI><strong>セキュリティの強化</strong>&nbsp;  ユーザーが少数で、セキュリティの強化が必要なリソースの場合、管理者は一対一マッピングを使います。これによって、管理者は、使用される証明書を限定することができます。これにより、より強力な証明書無効化のポリシーを実施できます。</LI>

<LI><strong>インターネット</strong>&nbsp;<EM></EM>  証明書認証を行うインターネット サイトでは、広範囲の証明書を幅広く受け付け、それらの証明書すべてを IUSR_<i>computername</i> アカウントと同様の権限を持つアカウントにマップすることで、多対一マッピングを使用します。</LI>

<LI><strong>証明機関別対応</strong>&nbsp;  特定の機関が発行したクライアント証明書を使ってログオンするユーザーすべてをマップするには、多対一マッピングを使用し、その機関が発行した証明書を自動的にユーザー アカウントにマップする一致規則を定義することができます。</LI>
</UL>

<p><strong>注</strong>&nbsp;&nbsp;&nbsp;ワイルドカードで柔軟なマッピングを行うには、IIS のマッピング機能を使用します。マッピングを使用して Web サイトを Windows ドメインに統合している場合は、Windows の DS マッパーの方が適しています。詳細については、Windows のマニュアルを参照してください。</p>


<h2><a name="exportingmap"></a>証明書をエクスポートする</h2>
<p>一部の証明書は、IIS の一対一マッピングで使用する場合に &quot;エクスポート&quot; する必要があります。多対一マッピングでは、証明書をエクスポートする必要はありません。詳細については、証明機関にお問い合わせください。 </p>

<big>Internet Explorer Version&nbsp;4.0 以降を使って証明書をエクスポートするには</big>
<p>この手順を使って、証明書のバックアップ コピーを作成することもできます。</p>

<OL>
<LI>Internet Explorer で、[表示] メニューの [インターネット オプション] をクリックします。Internet Explorer Version 5.0 の場合は、[ツール] メニューの [インターネット オプション] をクリックします。</LI>
<LI>[インターネット オプション] プロパティ シートの [コンテンツ] をクリックします。</LI>
<LI>[コンテンツ] プロパティ シートの [証明書] をクリックして、[個人] をクリックします。</LI>
<LI>一覧から該当する証明書を選択して、[エクスポート] をクリックします。</LI>
<LI>ウィザードで [次へ] をクリックし、[いいえ、秘密キーをエクスポートしません] を選択して、[次へ] をクリックします。</LI>
<LI>次のページで、[Base64 encoded X509 (CER)] を選択して、[次へ] をクリックします。ウィザードの説明に従って、手順を完了します。</LI>
<P>これでこの証明書は、IIS 一対一マッピングで使用できるようになります。この手順は、証明書ごとに一度だけ実行します。</P>
</OL>


<H2><a name="mapping"></a>証明書をマップする手順</H2>
<P>一対一マッピングでは、個別のクライアント証明書をアカウントにマップします。多対一マッピングでは、&quot;ワイルドカード&quot; による一致規則を使って、クライアント証明書が、発行者やサブジェクトなどの特定情報を含むかどうかを検査します。</P>

<a name="1to1map"></a><big>一対一マッピングで特定のクライアント証明書をユーザー アカウントにマップするには</big><!--</p>--><br>

<ol>
<LI><a href="iiabuti.htm">IIS スナップイン</a>で、認証情報を設定する Web サイトを選択し、そのプロパティ シートを開きます。</LI>
<LI>[ディレクトリ セキュリティ] プロパティ シートで、[セキュリティ保護された通信] の [編集] をクリックします。</LI>
<LI>[セキュリティ保護された通信] ダイアログ ボックスにある [クライアント証明書のマッピングを有効にする] チェック ボックスをオンにし、[編集] をクリックします。</LI>
<LI>[アカウント マッピング] ダイアログ ボックスの [一対一] タブで、[追加] をクリックして新しい証明書を追加するか、または既存のマッピングを選択し、[マップの編集] をクリックしてそのマッピングを編集します。</LI>
<LI>新しい証明書を追加する場合は、目的の証明書ファイルを参照して開きます。</LI>

<P><STRONG>注</STRONG>&nbsp;&nbsp;&nbsp;目的の証明書ファイルが見つからない場合は、そのファイルをエクスポートする必要があります。</P>

<LI>[アカウントへのマップ] ダイアログ ボックスにマッピング用のマップ名を入力します。この名前は、[アカウント マッピング] ダイアログ ボックスの一覧に表示されます。</LI>
<LI>Windows のユーザー アカウントを入力するか、または参照します。証明書をマッピングするアカウントのパスワードを入力します。</LI>
<LI>[OK] をクリックします。</LI>
<LI>ほかの証明書をマップする、またはこの証明書をほかのアカウントにマップする場合は、上記の手順を繰り返します。</LI>
</OL>

<a name="manymap"></a><big>多対一マッピングでワイルドカード規則を使用するクライアント証明書マッピングを追加するには</big><!--</p>--><br>

<P>多対一マッピングで使用する場合は、証明書をエクスポートする必要はありません。</P>

<ol>
<LI><a href="iiabuti.htm">IIS スナップイン</a>で、認証情報を設定する Web サイトを選択し、そのプロパティ シートを開きます。</LI>
<LI>[ディレクトリ セキュリティ] プロパティ シートで、[セキュリティ保護された通信] の [編集] をクリックします。</LI>
<LI>[セキュリティ保護された通信] ダイアログ ボックスにある [クライアント証明書のマッピングを有効にする] チェック ボックスをオンにし、[編集] をクリックします。</LI>
<LI>[アカウント マッピング] ダイアログ ボックスの [多対一] タブで、[追加] をクリックします。</LI>
<LI>[全般] ダイアログ ボックスに規則の名前を入力します。この名前は、[アカウント マッピング] ダイアログ ボックスの一覧に表示されます。[このワイルドカードの規則を有効にする] チェック ボックスをオンにすると、今後使用する規則を作成できます。オフにすると、規則を削除せずに無効にすることができます。[次へ] をクリックします。</LI>
<LI>[規則] ダイアログ ボックスの [新規作成] をクリックします。</LI>
<LI>[規則要素の編集] ダイアログ ボックスで、適切な条件を選択し、[OK] をクリックします。</LI>

<P><STRONG>注</STRONG>&nbsp;&nbsp;&nbsp;手順 6 および 7 を繰り返して、より厳密な規則を定義することもできます。</P>

<LI>設定終了後、[次へ] をクリックします。</LI>

<LI>[マッピング] ダイアログ ボックスで、Windows のユーザー アカウントを入力または参照します。規則をマップするアカウントのパスワードを入力します。</LI>

<P><STRONG>注</STRONG>&nbsp;&nbsp;&nbsp;マップするアカウントが、ワークグループのメンバであるコンピュータ上に存在する場合は、コンピュータ名とアカウント名を指定する必要があります。たとえば、Sales1 というコンピュータ上の RegionalSales アカウントにマップする場合、マップするアカウント名は Sales1\RegionalSales となります。</P>

<LI>[OK] をクリックします。</LI>
<LI>ほかのマッピング規則を作成する場合は、上記の手順を繰り返します。</LI>
<li>規則の優先度を変更するには、[上に移動] と [下に移動] を使用します。一覧で上にある規則ほど優先されます。</li>
</OL>

<big>多対一マッピングで既存のワイルドカード規則を編集するには</big><!--</p>--><br>

<ol>
<LI><a href="iiabuti.htm">IIS スナップイン</a>で、認証情報を設定する Web サイトを選択し、そのプロパティ シートを開きます。</LI>
<LI>[ディレクトリ セキュリティ] プロパティ シートで、[セキュリティ保護された通信] の [編集] をクリックします。</LI>
<LI>[セキュリティ保護された通信] ダイアログ ボックスにある [クライアント証明書のマッピングを有効にする] チェック ボックスをオンにし、[編集] をクリックします。</LI>
<LI>[アカウント マッピング] ダイアログ ボックスの [多対一] タブで、規則を選択して [規則の編集] をクリックします。</LI>
<LI>必要に応じて編集します。</LI>
<LI>編集後、[OK] をクリックします。</LI>
</OL>


<p class="bigfix">&nbsp;</p>
	
<p><strong>注</strong>
<ul>
<li>具体的に指定されたクライアント証明書マッピングは、ワイルドカードで指定されたマッピングより常に優先されます。</li>
<li>いくつかのクライアント証明書は、識別情報量が多く提供され、カスタム フィールドなどが追加されている可能性があります。証明書の形式については、証明機関にお問い合わせください。</li>
<li>一致規則はできるだけ具体的にします。そのためには、複数の異なるフィールドおよびサブフィールドの情報を使用して、ワイルドカード一致規則を構成します。たとえば、Accounting、Shipping、Sales などの名前は、複数の組織のクライアント証明書の部門サブフィールドで使われている可能性があります。このサブフィールドだけを条件として証明書をマップする一致規則では、意図したとおりにマップされない場合があります。</li>
</ul>
</p>


<hr class="iis" size="1">
<p align="center"><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation.All rights reserved.</a></em></p>

</font>
</body>
</html>
