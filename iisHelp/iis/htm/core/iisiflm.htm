<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=LTR>
<HEAD>

<TITLE>#flastmod</TITLE>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="インターネット インフォメーション サービスのリファレンス ページです。#flastmod ディレクティブは、指定されたファイルの修正時刻を HTML ページに挿入するよう、Web サーバーに命令します。">

<META HTTP-EQUIV="Content-Type" content="text/html; charset=shift_jis">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="JA">
<META NAME="MS-IT-LOC" Content="インターネット インフォメーション サービス">

</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H2><A NAME="_k2_flastmod"></A><SUP></SUP>#flastmod</H2>

<p><b> #flastmod</b> ディレクティブは、指定されたファイルの前回の修正時刻を挿入するよう Web サーバーに命令します。ディレクティブは、HTML のコメント デリミタで囲む必要があります。</p>
<p>既定値では、このディレクティブは STM ページでのみ使用できます。ASP ページでは使用できません。このタスクを ASP スクリプトで実行するには、<b> FileSystemObject</b> オブジェクトを使用します。これについては、<a href="http://www.microsoft.com/isapi/redir.dll?prd=msdn&amp;pver=6.0&amp;ar=scripting" target="_blank">MSDN</a> の VBScript または JScript の項に記載されています。
</p>

<H6>構文</H6>

<P><strong>&lt;!-- #flastmod </strong><em>PathType</em><strong> = </strong><em>FileName</em> <strong>--&gt;</strong></P>

<H6>パラメータ</H6>

<P><em>PathType</em></P>

<P><em>FileName</em> へのパスの種類を指定します。パスの種類は、次のいずれか 1 つを指定できます。</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all width=100%>

<TR VALIGN="top">
<TD width=20%><STRONG>パスの種類</STRONG></TD>
<TD width=80%><STRONG>意味</STRONG></TD>
</TR>

<TR VALIGN="top">
<TD width=20%> File </TD>
<TD width=80%>ファイル名は、#flastmod ディレクティブが入ったドキュメントがあるディレクトリからの相対パスです。 </TD>
</TR>

<TR VALIGN="top">
<TD width=20%>仮想</TD>
<TD width=80%>ファイル名は、Web サイトの仮想ディレクトリからのフル パスです。</TD>
</TR>
</TABLE><BR>

<P><em>FileName</em></P>

<P>前回アップデートした時刻を求めるファイルの名前を指定します。FileName には、ファイル名拡張子を含める必要があります。また、ファイル名は、二重引用符 (&quot;) で囲む必要があります。</P>

<font face="ＭＳ Ｐゴシック">

<P><strong><font color="#0000FF">重要</strong></font>&nbsp;&nbsp;&nbsp;このディレクティブが入ったファイルには、SSI インタプリタにマップされるファイル名拡張子を使う必要があります。拡張子が異なると、Web サーバーはディレクティブを処理しません。既定では、ファイル名拡張子 .stm、.shtm、および .shtml が SSI インタプリタ (ssinc.dll) にマップされます。</P>

<P>#echo ディレクティブを使用する STM ページは、それ自身または ASP ページから Response.Redirect を使用して実行する必要があります。STM ページを ASP ページから Server.Transfer、Server.Execute、または #include を使用して呼び出すと、STM ページが ssinc.dll ではなく asp.dll を通過するよう強制されるため、機能しません。</P>

<P><a href="iiabuti.htm">IIS スナップイン</a>をインストールしている場合、既定の拡張子マッピングを変更して新しいマッピングを追加できます。詳細については、「<A HREF="iiwarndf.htm">アプリケーションのマッピングを設定する</a>」を参照してください。ファイル拡張子を複数の実行可能ファイルにマップすることはできないため、このディレクティブを ASP ファイルでは使用できません。ASP ファイルは、既に asp.dll にマップされていて、そのまま保持する必要があります。</P>

<H6><b>例</b></H6>

<p>--- SSI.stm ---</p>

<pre>&lt;!-- #config ERRMSG = &quot;An error occurred processing a directive.&quot; --&gt;

SSI.stm was last formatted on 
&lt;!-- #config TIMEFMT = &quot;%A, the %d of %B, %Y, at %H:%M&quot; --&gt;
&lt;!-- #flastmod FILE = &quot;ssi.stm&quot; --&gt;
&lt;BR&gt;

The size of SSI.stm in bytes is
&lt;!-- #config SIZEFMT = &quot;BYTES&quot; --&gt;
&lt;!-- #fsize FILE = &quot;ssi.stm&quot; --&gt;
&lt;BR&gt;&lt;BR&gt;

This line will print out the ERRMSG configured above&lt;BR&gt;
&lt;!-- #config SIZEFMT = &quot;BYTE&quot; --&gt;
</pre>

</font>
<hr class="iis" size="1">
<p align="center"><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation.All rights reserved.</a></em></p>
</BODY>
</HTML>
