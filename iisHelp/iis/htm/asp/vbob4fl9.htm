<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR=LTR>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=shift_jis">
<TITLE>Form</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> <SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="インターネット インフォメーション サービス リファレンス情報">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="JA">
<META NAME="MS-IT-LOC" Content="インターネット インフォメーション サービス"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H4><A NAME="_form"></A><SUP></SUP>Form</H4>

<P>Form コレクションは、POST メソッドを使用してフォームから HTTP 要求本体にポストされた、フォーム要素の値を取得します。</P>

<H6>構文</H6>

<P>Request.<B>Form</B>(<I>element</I>)[(<I>index</I>)|.Count]</P>

<P>&nbsp;</P>

<H6>パラメータ</H6>

<DL>
<DT><I>element</I></DT>

<DD>コレクションが値を取得するフォーム要素の名前です。<br>
</DD>

<DT><I>index</I></DT>

<DD>パラメータの複数の値のうちの 1 つにアクセスできるようにするための省略可能なパラメータです。1 〜 Request.Form(<i>parameter</i>).Count の整数値を指定できます。</DD>
</DL>

<H6>解説</H6>

<P>Form コレクションは、要求本体のパラメータ名別にインデックスが付けられます。Request.Form(<i>element</i>) の値は、要求本体に出現するすべての <i>element</i> の値の配列になります。パラメータの値の数は、Request.Form(<i>element</i>).Count を呼び出して調べることができます。パラメータに関連付けられている値が複数でない場合は、個数は 1 になります。パラメータが見つからない場合は、個数は 0 になります。</P>

<P>複数の値を持つフォーム要素のある値を参照するには、値を <i>index</i> で指定する必要があります。パラメータ <i>index</i> には 1 〜 Request.Form(<i>element</i>).Count までの値を指定できます。<i>index</i> の値を指定せずに複数のフォーム パラメータの 1 つを参照した場合、データはカンマで区切られた文字列として返されます。</P>

<P>Request.Form でパラメータを使用すると、Web サーバーはその HTTP 要求本体を解析して、指定されたデータを返します。未解析のフォーム データがアプリケーションで必要な場合は、パラメータを指定せずに Request.Form を呼び出すことで取得できます。</P>

<P><span class=le><B>注&nbsp; </B></span>ASP を使用し、100 KB を超えるデータのポストを行う場合、Request.Form は使用できません。100 KB を超えるデータのポストをアプリケーションが必要とする場合、Request.BinaryRead メソッドを使用してコンポーネントを記述することができます。</P>

<P>ループを使用することで、フォーム要求内のすべてのデータ値を取得できます。たとえば、ユーザーが要素 FavoriteFlavor に対して Chocolate および Butterscotch という 2 つの値を指定してフォームに入力した場合、次のようなスクリプトを使用してこれらの値を取得できます。</P>

<PRE><CODE>&lt;%
  For i = 1 To Request.Form("FavoriteFlavor").Count
    Response.Write Request.Form("FavoriteFlavor")(i) &amp; "&lt;BR&gt;"
  Next
%&gt;
</CODE></PRE>

<P>上のスクリプトの表示結果は、次のようになります。</P>

<PRE><CODE>Chocolate
Butterscotch
 </CODE></PRE>

<P>このループを使用して、次のスクリプトのようにパラメータ名を表示することができます。</P>

<PRE><CODE>&lt;% 
  For i = 1 to Request.Form("FavoriteFlavor").count %&gt;
    Request.Form(FavoriteFlavor) = &lt;%= Request.Form("FavoriteFlavor")(i)_
    %&gt; &lt;BR&gt;
&lt;% Next %&gt;
 </CODE></PRE>

<P>ブラウザには、次のように表示されます。 </P>

<PRE><CODE>Request.Form(FavoriteFlavor) = Chocolate
Request.Form(FavoriteFlavor) = Butterscotch
 </CODE></PRE>

<H6>例</H6>

<P>次のようなフォームがあるとします。</P>

<PRE><CODE>&lt;FORM ACTION = "/scripts/submit.asp" METHOD = "post"&gt;
&lt;P&gt;Your first name: &lt;INPUT NAME = "firstname" SIZE = 48&gt;
&lt;P&gt;What is your favorite ice cream flavor: &lt;SELECT NAME = "flavor"&gt;
&lt;OPTION&gt;Vanilla 
&lt;OPTION&gt;Strawberry 
&lt;OPTION&gt;Chocolate 
&lt;OPTION&gt;Rocky Road&lt;/SELECT&gt;
&lt;P&gt;&lt;INPUT TYPE = SUBMIT&gt;
&lt;/FORM&gt;
 </CODE></PRE>

<P>このフォームから次の要求本体が送信されたとします。</P>

<PRE><CODE>firstname=James&amp;flavor=Rocky+Road
 </CODE></PRE>

<P>次のスクリプトが使えます。 </P>

<PRE><CODE>Welcome,  &lt;%= Request.Form("firstname") %&gt;. 
Your favorite flavor is &lt;%= Request.Form("flavor") %&gt;.
 </CODE></PRE>

<P>出力結果は、次のようになります。</P>

<PRE><CODE>Welcome, James. Your favorite flavor is Rocky Road.
 </CODE></PRE>

<P>次のようなスクリプトを使用したとします。</P>

<PRE><CODE>The unparsed form data is:  &lt;%= Request.Form %&gt; 
 </CODE></PRE>

<P>次のような出力が得られます。</P>

<PRE><CODE>The unparsed form data is:  firstname=James&amp;flavor=Rocky+Road
 </CODE></PRE>

<P><span class=le><B>注&nbsp;&nbsp;&nbsp;</B></span>フォームに同じ名前を持つオブジェクト (HTML SELECT タグなど) が複数含まれている場合、Form コレクションの項目は、選択された値すべてがカンマで区切られている一覧になります。</P>

<H6>対象</H6>

<P>Request オブジェクト</P>

<H6>関連項目</H6>

<P><A HREF="/iishelp/iis/htm/asp/vbob8q5h.htm"><B>ClientCertificate</B></A>、<A HREF="/iishelp/iis/htm/asp/vbob0z3o.htm"><B>Cookies</B></A>、<A HREF="/iishelp/iis/htm/asp/vbob53hj.htm"><B>QueryString</B></A>、<A HREF="/iishelp/iis/htm/asp/vbob5vsj.htm"><B>ServerVariables</B></A></P>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation.All rights reserved.</a></em></p>
</BODY>
</HTML>
