<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR=LTR>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=shift_jis">
<TITLE>Restore</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> <SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="インターネット インフォメーション サービス リファレンス情報">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="JA">
<META NAME="MS-IT-LOC" Content="インターネット インフォメーション サービス"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H3><A NAME="_k2_restore"></A><SUP></SUP>Restore</H3>

<P><A HREF="/iishelp/iis/htm/asp/aore2xpu.htm">IIsComputer</A> オブジェクトの Restore メソッドは、バックアップからメタベースを復元します。復元操作では、IISADMIN に依存する、すべてのサーバーを含むすべてのサービスを、復元が完了するまで停止し、完了後にすべてのサービスを再開します。このため、ASP ページの中でスクリプトを使用してメタベースを復元する場合は、スクリプトを実行するコンピュータ以外のコンピュータ名を指定する必要があります。LocalHost をコンピュータ名として指定することはできません。バックアップからメタベースを復元するときは、このサービスの中断を慎重に計画する必要があります。</P>

<H6>構文</H6>

<P><B>IIsComputer</B>.<B>Restore</B> <I>BackupLocation</I>, <I>BackupVersion</I>, <I>BackupFlags</I> </P>

<P>&nbsp;</P>

<H6>パラメータ</H6>

<DL>
<DT><I>BackupLocation</I></DT>

<DD>バックアップ場所を指定する 100 字以内の文字列です。空の文字列を指定すると、バックアップは既定の場所から取り出されます。<BR>
</DD>

<DT><I>BackupVersion</I></DT>

<DD>バックアップ場所から復元するバックアップのバージョン番号、または次に示す定数を指定します。

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=cols>

<TR VALIGN="top">
<TD width=50%><B>MD_BACKUP_HIGHEST_VERSION</B></TD>
<TD width=50%>指定されたバックアップ場所の中で最もバージョン番号が大きいバックアップから復元します。</TD>
</TR>
</TABLE><BR>

<BR>
</DD>

<DT><I>BackupFlags</I></DT>

<DD>予約されています。必ず 0 を指定します。</DD>
</DL>

<H6>コード例</H6>

<PRE><CODE>&lt;% 
  Dim ComputerObj, ComputerName 
  'Restore metabase on a different computer. 
  ComputerName = "MyOtherComputer"
  'You can use LocalHost if running under Windows Script Host. 
  Set ComputerObj = GetObject("IIS://" &amp; ComputerName) 
  'Restore the highest number version in MyBackups. 
  ComputerObj.Restore "MyBackups", MD_BACKUP_HIGHEST_VERSION, 0 
%&gt; 
 </CODE></PRE>

<H6>解説</H6>

<P>Cscript.exe を使用しコマンド ウィンドウで実行するスクリプトで、LocalHost を指定して Restore メソッドを使用することができます。詳細については、Windows のマニュアルの Windows Script Host に関する箇所を参照してください。</P>

<P><span class=le><B>重要&nbsp;&nbsp;&nbsp;</B></span>メタベースのバックアップおよび復元機能は、バージョン化が目的であって、コンピュータ間での複製が目的ではありません。ただし、プロセスを開始するコンピュータの復元に制限する必要はありません。バックアップからの復元の詳細については、IIS の製品マニュアルの「メタベースを復元する」を参照してください。</P>

<H6>関連項目</H6>

<P><A HREF="/iishelp/iis/htm/asp/aore32cw.htm"><B>Backup</B></A>、<A HREF="/iishelp/iis/htm/asp/aore1v8z.htm"><B>EnumBackups</B></A>、<A HREF="/iishelp/iis/htm/asp/aore79rk.htm"><B>DeleteBackup</B></A></P>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation.All rights reserved.</a></em></p>
</BODY>
</HTML>
