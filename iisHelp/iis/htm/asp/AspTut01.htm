<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=LTR>
<head>
<title>モジュール 1 : ASP ページの作成</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</SCRIPT> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//-->
</SCRIPT>

<META NAME="DESCRIPTION" CONTENT="自分で ASP ページを作成し、ASP の基礎を学ぶための Active Server Pages (ASP) チュートリアルです。">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=shift_jis">
</head>

<body bgcolor="#ffffff" text="#000000">

<font face="ＭＳ Ｐゴシック">

<h1><a name="module1">モジュール 1 : ASP ページの作成</a></h1>

<p>
モジュール 1 では、HTML および Microsoft&reg; Visual Basic&reg; Scripting Edition (VBScript) を使用して ASP ページ (.asp ファイル) を作成します。このモジュールには、次に示す演習が含まれています。
</p>

<p>
<ul>
	<li>
	<A href="#writing">演習 1 : ASP ページの作成</A>&nbsp;&nbsp;&nbsp;HTML および VBScript を使用して ASP ページを作成し、実行する方法の例を 4 つ示します。
	</li><li>
	<A href="#submitting">演習 2 : フォームを使用した情報の送信</A>&nbsp;&nbsp;&nbsp;HTML ページにフォームを作成し、ユーザーが個人データを入力できるようにします。
	</li><li>
	<A href="#creating">演習 3 : ゲスト ブックの作成</A>&nbsp;&nbsp;&nbsp;フォームを使用して利用者から情報を収集し、Microsoft Access データベースにそれらの情報を格納し、Web ページでデータベースの内容を表示します。
	</li><li>
	<A href="#displaying">演習 4 : Excel スプレッドシートの表示</A>&nbsp;&nbsp;&nbsp;Web ページに Microsoft Excel スプレッドシートを表示します。
	</li>
</ul>

<BR>
<h2><a name="writing">演習 1 : ASP ページの作成</a></h2>

<p>
ASP について学習する最もよい方法は、例を見て、興味のある整数値、文字列、およびステートメントを変更し、ブラウザでどのような変化があったのかを表示してみることです。
</p>

<p>
この演習では、次に示すタスクを実行します。
</p>

<ul>
    <li>
	<b>例 1&nbsp;&nbsp;&nbsp;</b>HTML および VBScript を使用して ASP ページを作成、保存、および実行します。
    </li><li>
	<b>例 2、3、および 4&nbsp;&nbsp;&nbsp;</b>組み込み関数および条件スクリプト ステートメントを使用することによって ASP ページに機能およびロジックを追加します。
    </li>
</ul>


<p>
VBScript は、ASP ページの既定のスクリプト言語ですが、デリミタは JScript のものと同じです。.htm ページの場合と同様に、次のようにデリミタとして &lt; と &gt; かっこを使用して HTML タグを囲みます。
</p>

<code>
&nbsp; &lt;<i>example</i>&gt;&lt;/<i>example</i>&gt;
</code>

<p>
次のように、スクリプト コードを囲むデリミタとしてのかっことともにパーセント記号を使用します。
</p>

<code>
&nbsp; &lt;% <i> example</i> %&gt;
</code>

<p>
&nbsp;</p>

<p>
次の例に示すように、スクリプト デリミタの 1 つのペアの中に多数のスクリプト ステートメントを入れることができます。</p>

<code>
<p>
&nbsp; &lt;font face="MS Gothic"&gt;
<BR>&nbsp; &lt;%
<BR>&nbsp;&nbsp; 'Create&nbsp;a variable.
<BR>&nbsp;&nbsp; dim strGreeting
<BR>
<BR>&nbsp;&nbsp; 'Set the greeting.
<BR>&nbsp;&nbsp; strGreeting = "Hello  World!"
<BR>
<BR>&nbsp;&nbsp; 'Print out the greeting, using the ASP Response object.
<BR>&nbsp;&nbsp; Response.Write strGreeting &amp; "&lt;BR&gt;"
<BR>
<BR>&nbsp;&nbsp; 'Also print out the greeting using the &lt;%= method.
<BR>&nbsp; %&gt;
<BR>&nbsp; &lt;%=strGreeting%&gt;
<BR>&nbsp; &lt;/font&gt;
</p>
</code>

<P>
&nbsp;
</P>

<P>
このコードは、ブラウザに次のテキストを表示します。
</P>
<P>
<FONT face="MS Gothic">&nbsp; Hello World!<BR>&nbsp; Hello World!</FONT>
</P> 
 
&nbsp;
<p>JScript を使用して前の例を作成したものを次に示します。</p>
<p>

<code>
&nbsp; &lt;%@ Language=JScript %&gt;
<BR>
<BR>&nbsp; &lt;font face=&quot;MS Gothic&quot;&gt;
<BR>&nbsp; &lt;%
<BR>&nbsp;&nbsp; //Create&nbsp;a variable.
<BR>&nbsp;&nbsp; var strGreeting;
<BR>
<BR>&nbsp;&nbsp; //Set the greeting.
<BR>&nbsp;&nbsp; strGreeting = &quot;Hello World!&quot;;
<BR>
<BR>&nbsp;&nbsp; //Print out the greeting, using the ASP Response object.
<BR>&nbsp;&nbsp; Response.Write(strGreeting + &quot;&lt;BR&gt;&quot;);
<BR>
<BR>&nbsp;&nbsp; //Also print out the greeting using the &lt;%= method.
<BR>&nbsp; %&gt;
<BR>&nbsp; &lt;%=strGreeting%&gt;
<BR>&nbsp; &lt;/font&gt;
</code>
<p>
ASP ページを作成するには、メモ帳などのテキスト エディタを使用し、.htm ではなく .asp 拡張子を付けてページを保存します。.asp ファイル名拡張子によって、IIS はクライアントにページを送信する前に ASP エンジンを使用してページを送信します (<b>注</b> メモ帳の [名前を付けて保存] ダイアログ ボックスの [ファイルの種類] ボックスで、[テキスト文書 (*.txt)] を選択すると、ファイル名に .txt が自動的に付加されます。これを回避するには、[ファイルの種類] ボックスで [すべてのファイル] を選択し、[ファイル名] フィールドに完全なファイル名 <I>MyFile</I>.asp を入力して [保存] をクリックします)。 
</P>

<p> 
 
<br></p>
<h3>例 1</h3>

<p>
この例では、挨拶、日付、および現在の時刻を表示します。この例を実行するには、次のコードをコピーして空のファイルに貼り付け、それに Example1.asp という名前を付けて <i>x</i>:\Inetpub\Wwwroot\Tutorial ディレクトリに保存します。アドレス バーに「http://localhost/Tutorial/Example1.asp」と入力し、ブラウザでこの例を表示します。
</p>
   

  
<code>
<p>
&nbsp; &lt;%@ Language=VBScript %&gt;
<BR>
<BR>&nbsp; &lt;html&gt;
<BR>&nbsp; &lt;head&gt;
<BR>&nbsp; &lt;title&gt;Example 1&lt;/title&gt;
<BR>&nbsp; &lt;/head&gt;
<BR>&nbsp; &lt;body&gt;
<BR>&nbsp; &lt;font face="MS Gothic"&gt;
<BR>
<BR>&nbsp; &lt;H1&gt;Welcome to my Home Page&lt;/H1&gt;
<BR>&nbsp; &lt;%
<BR>&nbsp;&nbsp; 'Create some variables.
<BR>&nbsp;&nbsp; dim strDynamicDate
<BR>&nbsp;&nbsp; dim strDynamicTime
<BR>
<BR>&nbsp;&nbsp; 'Get the date and time.
<BR>&nbsp;&nbsp; strDynamicDate = Date()
<BR>&nbsp;&nbsp; strDynamicTime = Time()
<BR>
<BR>&nbsp;&nbsp; 'Print out a greeting, depending on the time, by comparing the last 2 characters in strDymamicTime to "PM".
<BR>&nbsp;&nbsp; If "PM" = Right(strDynamicTime, 2) Then
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;H3&gt;Good Afternoon!&lt;/H3&gt;"
<BR>&nbsp;&nbsp; Else
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;H3&gt;Good Morning!&lt;/H3&gt;"
<BR>&nbsp;&nbsp; End If
<BR>&nbsp; %&gt;
<BR>&nbsp; Today's date is &lt;%=strDynamicDate%&gt; and the time is &lt;%=strDynamicTime%&gt;&nbsp;
<BR>
<BR>&nbsp; &lt;/font&gt;
<BR>&nbsp; &lt;/body&gt;
<BR>&nbsp; &lt;/html&gt;
</P>
</code>

<P>
ブラウザには、次のような文字が表示されます (この例を実行する日付と時刻に応じて変わります)。
</P>
<font face="MS Gothic"> 
<P>
<H1>&nbsp;Welcome to my Home Page</H1> 
<H3>&nbsp; Good Afternoon!</H3> 
&nbsp; Today's date is 10/20/2000 and the time is 7:29:50 PM</font>
<p></p>
<br>
<p>
</p>
<p><b>注 : </b>Web サーバーは次の順序で Example1.asp を処理します。
</p>

<ol>
	<li>
	&lt;%@ Language=VBScript %&gt; は、ASP エンジンに、VBScript エンジンを使用してスクリプト コードを変換するように指示します。</li>  
	<li>
	ASP エンジンは HTML コード ブロックを無視します。
	</li>  
	<li>
	ASP エンジンは &lt;%...%&gt; ブロック内のコードを実行し、ブロックをプレースホルダと置き換えます。Response.Write 文字列および <i>&lt;%=...%&gt;</i> 文字列の結果は、サーバー上のメモリに保存されます。</li> 
	<li>
	Response.Write 文字列および <i>&lt;%=...%&gt;</i> 文字列の結果は、ASP エンジンがそのページの処理を終了する前に、一致するプレースホルダの位置の HTML コードに挿入されます。
	</li> 
	<li>
	ASP エンジンによる処理が完了したページは HTML コードのファイルになり、サーバーによってクライアントに送信されます。
	</li>
</ol>
<BR><h3>例 2</h3>

<p>
この例では、ASP ページに For...Next ループを組み込み、多少動的なロジックを追加します。For...Next ループは、使用可能な 6 つの条件ステートメントの 1 つです。ほかの 5 つは、Do...Loop、For Each...Next、If...Then...Else...End If、Select..Case...End Select、および While...Wend です。これらのステートメントは、<a href="http://www.microsoft.com/isapi/redir.dll?prd=msdn&pver=6.0&ar=scripting" target="_blank">Windows Script Technologies</a> の「VBScript」に記載されています。 
</p>

<P>
次に示すコードをコピーし、テキスト エディタで新しいファイルに貼り付け、Example2.asp と名前を付けて保存します。アドレス バーに「http://localhost/Tutorial/Example2.asp」と入力し、ブラウザでこの例を表示します。
</p>         
     
<P>
処理順序は、Example1.asp の場合と同じです。
</p>

<code>
<p>
&nbsp; &lt;%@ Language=VBScript %&gt;&nbsp;
<BR>
<BR>&nbsp; &lt;html&gt;
<BR>&nbsp; &lt;head&gt;
<BR>&nbsp; &lt;title&gt;Example 2&lt;/title&gt;
<BR>&nbsp; &lt;/head&gt;
<BR>&nbsp; &lt;body&gt;
<BR>&nbsp; &lt;font face="MS Gothic"&gt;
<BR>
<BR>&nbsp; &lt;%
<BR>&nbsp;&nbsp; 'Create&nbsp;a variable.
<BR>&nbsp;&nbsp; dim strTemp
<BR>&nbsp;&nbsp; dim font1, font2, font3, font, size
<BR>
<BR>&nbsp;&nbsp; 'Set the variable.
<BR>&nbsp;&nbsp; strTemp= "BUY MY PRODUCT!"
<BR>&nbsp;&nbsp; fontsize = 0
<BR>
<BR>&nbsp;&nbsp; 'Print out the string 5 times using the For...Next loop.
<BR>&nbsp;&nbsp; For i = 1 to 5
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Close the script delimiters to allow the use of HTML code and &lt;%=...
<BR>&nbsp;&nbsp;&nbsp;&nbsp; %&gt;.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;table align=center&gt;&lt;font size= &lt;%=fontsize%&gt;&gt; &lt;%=strTemp%&gt; &lt;/font&gt;&lt;/table&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;%
<BR>&nbsp;&nbsp;&nbsp;&nbsp; fontsize = fontsize + i
<BR>
<BR>&nbsp;&nbsp; Next
<BR>
<BR>&nbsp; %&gt;
<BR>&nbsp; &lt;table align=center&gt;&lt;font size=6&gt;&lt;B&gt; IT ROCKS! &lt;B&gt;&lt;/font&gt;&lt;/table&gt;&lt;BR&gt;
<BR>
<BR>&nbsp; &lt;/font&gt;
<BR>&nbsp; &lt;/body&gt;
<BR>&nbsp; &lt;/html&gt; 
</P>
</code>

<P>
ブラウザには、次のように表示されます。
</P>

<P>
<FONT face="MS Gothic">
<TABLE align=center><FONT size=0>BUY MY PRODUCT! </FONT></TABLE>
<TABLE align=center><FONT size=1>BUY MY PRODUCT! </FONT></TABLE>
<TABLE align=center><FONT size=3>BUY MY PRODUCT! </FONT></TABLE>
<TABLE align=center><FONT size=6>BUY MY PRODUCT! </FONT></TABLE>
<TABLE align=center><FONT size=10>BUY MY PRODUCT! </FONT></TABLE>
<TABLE align=center><FONT size=6><B>IT ROCKS! </B></FONT></TABLE>
</FONT>
<P>
&nbsp;
<p>JScript を使用して例 2 を作成したものを次に示します。</p>
<p>

<code>
&nbsp; &lt;%@ Language=JScript %&gt;
<BR>
<BR>
&nbsp; &lt;html><br>
&nbsp; &lt;head><br>
&nbsp; &lt;title>Example 2&lt;/title><br>
&nbsp; &lt;/head><br>
&nbsp; &lt;body><br>
&nbsp; &lt;font face="MS Gothic"><br>
<br>
&nbsp; &lt;%<br>
&nbsp; //Create?a variable.<br>
&nbsp; var strTemp;<br>
&nbsp; var font1, font2, font3, font, size;<br>
<br>
&nbsp; //Set the variable.<br>
&nbsp; strTemp= "BUY MY PRODUCT!";<br>
&nbsp; fontsize = 0;<br>
<br>
&nbsp; //Print out the string 5 times using the For...Next loop.<br>
&nbsp; for (i = 1; i &lt; 6; i++) {<br>
<br>
&nbsp; //Close the script delimiters to allow the use of HTML code and &lt;%=...<br>
&nbsp; %>.<br>
&nbsp; &lt;table align=center>&lt;font size= &lt;%=fontsize%>> &lt;%=strTemp%> &lt;/font>&lt;/table><br>
&nbsp; &lt;%<br>
&nbsp; fontsize = fontsize + i;<br>
<br>
&nbsp; }<br>
<br>
&nbsp; %><br>
&nbsp; &lt;table align=center>&lt;font size=6>&lt;B> IT ROCKS! &lt;B>&lt;/font>&lt;/table>&lt;BR><br>
<br>
&nbsp; &lt;/font><br>
&nbsp; &lt;/body><br>
&nbsp; &lt;/html></code>

</p>

<h3>例 3</h3>
<p>企業が、世界中に製品を提供することの必要性を認識するようになり、多言語対応の Web サイトが日々増加しています。これに伴い、日付、時刻、および通貨の形式をユーザーのロケールに合わせることが望まれます。

<p>
例 3 では、事前定義関数によって、ASP ページに日付と通貨を表示します。日付と通貨は、GetLocale 関数、SetLocale 関数、FormatCurrency 関数、および FormatDateTime 関数を使用してさまざまなロケールに対応してフォーマットされます。ロケール識別文字列は、MSDN の Locale ID Chart に記載されています(この例には、ヨーロッパのオペレーティング システムでヨーロッパ以外の文字を表示するための CodePage の変更は含まれていません。詳細については、IIS マニュアルの CodePage のトピックを参照してください)。

<p>
<b>注 : </b>VBScript には 90 を超える事前定義関数があり、すべて <a href="http://www.microsoft.com/isapi/redir.dll?prd=msdn&pver=6.0&ar=scripting" target="_blank">Windows Script Technologies</a> で定義されています。この文書を表示するには、[VBScript] を選択し、[Documentation] を選択します。次に [Language Reference] を選択して [Functions] を選択します。  
</p>

<p>
次に示すコードをコピーし、テキスト エディタで新しいファイルに貼り付け、Example3.asp と名前を付けて <i>x</i>:\Inetpub\Wwwroot\Tutorial ディレクトリに保存します。アドレス バーに「http://localhost/Tutorial/Example3.asp」と入力し、ブラウザでこの例を表示します。
</p>

<code>
<p>
&nbsp; &lt;%@ Language=VBScript %&gt;
<BR>
<BR>&nbsp; &lt;html&gt;
<BR>&nbsp; &lt;head&gt;
<BR>&nbsp; &lt;title&gt;Example 3&lt;/title&gt;
<BR>&nbsp; &lt;/head&gt;
<BR>&nbsp; &lt;body&gt;
<BR>&nbsp; &lt;font face="MS Gothic"&gt;
<BR>
<BR>&nbsp; &lt;H3&gt;Thank you for your purchase. &nbsp;Please print this page for your records.&lt;/H3&gt;
<BR>&nbsp; &lt;%
<BR>&nbsp;&nbsp; 'Create&nbsp;some variable.
<BR>&nbsp;&nbsp; dim saveLocale
<BR>&nbsp;&nbsp; dim totalBill
<BR>
<BR>&nbsp;&nbsp; 'Set the variables.
<BR>&nbsp;&nbsp; saveLocale = GetLocale
<BR>&nbsp;&nbsp; totalBill = CCur(85.50)
<BR>
<BR>&nbsp;&nbsp; 'For each of the Locales, format the date and the currency
<BR>&nbsp;&nbsp; SetLocale("fr")
<BR>&nbsp;&nbsp; Response.Write"&lt;B&gt;Formatted for French:&lt;/B&gt;&lt;BR&gt;"
<BR>&nbsp;&nbsp; Response.Write FormatDateTime(Date, 1) &amp; "&lt;BR&gt;"
<BR>&nbsp;&nbsp; Response.Write FormatCurrency(totalBill) &amp; "&lt;BR&gt;"
<BR>&nbsp;&nbsp; SetLocale("de")
<BR>&nbsp;&nbsp; Response.Write"&lt;B&gt;Formatted for German:&lt;/B&gt;&lt;BR&gt;"
<BR>&nbsp;&nbsp; Response.Write FormatDateTime(Date, 1) &amp; "&lt;BR&gt;"
<BR>&nbsp;&nbsp; Response.Write FormatCurrency(totalBill) &amp; "&lt;BR&gt;"
<BR>&nbsp;&nbsp; SetLocale("en-au")
<BR>&nbsp;&nbsp; Response.Write"&lt;B&gt;Formatted for English - Australia:&lt;/B&gt;&lt;BR&gt;"
<BR>&nbsp;&nbsp; Response.Write FormatDateTime(Date, 1)&amp; "&lt;BR&gt;"
<BR>&nbsp;&nbsp; Response.Write FormatCurrency(totalBill) &amp; "&lt;BR&gt;"
<BR>
<BR>&nbsp;&nbsp; 'Restore the original Locale
<BR>&nbsp;&nbsp; SetLocale(saveLocale)
<BR>&nbsp; %&gt;
<BR>
<BR>&nbsp; &lt;/font&gt;
<BR>&nbsp; &lt;/body&gt;
<BR>&nbsp; &lt;/html&gt;
</p>
</code>

<P>
ブラウザには、次のように表示されます。
</P>

<p><H3><FONT face="MS Gothic">Thank you for your purchase.Please print this page for your records.</H3>
<B>&nbsp; Formatted for French:</B> <BR>&nbsp; vendredi 20 octobre 2000 <BR>&nbsp; 85,50 F <BR><B>&nbsp; Formatted for German:</B> <BR>&nbsp; Freitag, 20. Oktober 2000 <BR>&nbsp; 85,50 DM <BR><B>&nbsp; Formatted for English - Australia:</B> <BR>&nbsp; Friday, 20 October 2000 <BR>&nbsp; $85.50</FONT>

<h3>例 4</h3>

<p>
ASP スクリプトで使用される一般的な関数のほとんどは、文字列を操作する関数です。強力な文字列関数の大部分は、正規表現を使用します。正規表現は適応させるのが困難なため、例 4 では、文字列表現および正規表現を使用して文字列の文字を置換する方法を示します。正規表現は、<a href="http://www.microsoft.com/isapi/redir.dll?prd=msdn&pver=6.0&ar=scripting" target="_blank">Windows Script Technologies</a> で定義されています。&nbsp;この文書を表示するには、[VBScript] を選択し、[Documentation] を選択して、[Regular Expressions Guide] を選択します。 
</p>

<p>
次に示すコードをコピーし、テキスト エディタで新しいファイルに貼り付け、Example4.asp と名前を付けて <i>x</i>:\Inetpub\Wwwroot\Tutorial ディレクトリに保存します。アドレス バーに「http://localhost/Tutorial/Example4.asp」と入力し、ブラウザでこの例を表示します。
</p>

<code>
<p>
&nbsp; &lt;%@ Language=VBScript %&gt;
<BR>
<BR>&nbsp; &lt;html&gt;
<BR>&nbsp; &lt;head&gt;
<BR>&nbsp; &lt;title&gt;Example 4&lt;/title&gt;
<BR>&nbsp; &lt;/head&gt;
<BR>&nbsp; &lt;body&gt;
<BR>&nbsp; &lt;font face="MS Gothic"&gt;
<BR>
<BR>&nbsp; &lt;H3&gt;Changing a Customer's Street Address&lt;/H3&gt;
<BR>&nbsp; &lt;%
<BR>&nbsp;&nbsp; 'Create some variables.
<BR>&nbsp;&nbsp; dim strString
<BR>&nbsp;&nbsp; dim strSearchFor&nbsp;&nbsp;&nbsp;&nbsp; ' as a string
<BR>&nbsp;&nbsp; dim reSearchFor&nbsp;&nbsp;&nbsp;&nbsp; ' as a regular expression
<BR>&nbsp;&nbsp; dim strReplaceWith
<BR>
<BR>&nbsp;&nbsp; 'Set the variables.
<BR>&nbsp;&nbsp; strString = "Jane Doe&lt;BR&gt;100 Orange Road&lt;BR&gt;Orangeville, WA&lt;BR&gt;98100&lt;BR&gt;800.555.1212&lt;BR&gt;"
<BR>&nbsp;&nbsp; '&nbsp;&nbsp; Using a string object
<BR>&nbsp;&nbsp; strSearchFor = "100 Orange Road&lt;BR&gt;Orangeville, WA&lt;BR&gt;98100"
<BR>&nbsp;&nbsp; '&nbsp;&nbsp; Using a regular expression object
<BR>&nbsp;&nbsp; Set reSearchFor = New RegExp
<BR>&nbsp;&nbsp; reSearchFor.Pattern = "100 Orange Road&lt;BR&gt;Orangeville, WA&lt;BR&gt;98100"
<BR>&nbsp;&nbsp; reSearchFor.IgnoreCase = False
<BR>
<BR>&nbsp;&nbsp; strReplaceWith = "200 Bluebell Court&lt;BR&gt;Blueville, WA&lt;BR&gt;98200"
<BR>
<BR>&nbsp;&nbsp; 'Verify that strSearchFor exists...
<BR>&nbsp;&nbsp; '&nbsp;&nbsp; using a string object.
<BR>&nbsp;&nbsp; If Instr(strString, strSearchFor) Then
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "strSearchFor was found in strString&lt;BR&gt;"
<BR>&nbsp;&nbsp; Else
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "Fail"
<BR>&nbsp;&nbsp; End If
<BR>&nbsp;&nbsp; '&nbsp;&nbsp; using a regular expression object.
<BR>&nbsp;&nbsp; If reSearchFor.Test(strString) Then
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "reSearchFor.Pattern was found in strString&lt;BR&gt;"
<BR>&nbsp;&nbsp; Else
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "Fail"
<BR>&nbsp;&nbsp; End If
<BR>
<BR>&nbsp;&nbsp; 'Replace the string...
<BR>&nbsp;&nbsp; Response.Write "&lt;BR&gt;Original String:&lt;BR&gt;" &amp; strString &amp; "&lt;BR&gt;"
<BR>&nbsp;&nbsp; '&nbsp;&nbsp; using a string object.
<BR>&nbsp;&nbsp; Response.Write "String where strSearchFor is replaced:&lt;BR&gt;"
<BR>&nbsp;&nbsp; Response.Write Replace(strString, strSearchFor, strReplaceWith) &amp; "&lt;BR&gt;"
<BR>&nbsp;&nbsp; '&nbsp;&nbsp; using a regular expression object.
<BR>&nbsp;&nbsp; Response.Write "String where reSearchFor is replaced:&lt;BR&gt;"
<BR>&nbsp;&nbsp; Response.Write reSearchFor.Replace(strString, strReplaceWith) &amp; "&lt;BR&gt;"
<BR>&nbsp; %&gt;
<BR>
<BR>&nbsp; &lt;/font&gt;
<BR>&nbsp; &lt;/body&gt;
<BR>&nbsp; &lt;/html&gt;
</p>
</code>

<P>
ブラウザには、次のように表示されます。
</P>

<p>
<FONT face="MS Gothic"><H3>&nbsp;Changing a Customer's Street Address</H3>
&nbsp; strSearchFor was found in strString <BR>&nbsp; reSearchFor.Pattern was found in strString <BR> <BR>&nbsp; Original String: <BR>&nbsp; Jane Doe <BR>&nbsp; 100 Orange Road <BR>&nbsp; Orangeville, WA <BR>&nbsp; 98100 <BR>&nbsp; 800.555.1212 <BR> <BR>&nbsp; String where strSearchFor is replaced: <BR>&nbsp; Jane Doe <BR>&nbsp; 200 Bluebell Court <BR>&nbsp; Blueville, WA <BR>&nbsp; 98200 <BR>&nbsp; 800.555.1212 <BR> <BR>&nbsp; String where reSearchFor is replaced: <BR>&nbsp; Jane Doe <BR>&nbsp; 200 Bluebell Court <BR>&nbsp; Blueville, WA <BR>&nbsp; 98200 <BR>&nbsp; 800.555.1212</FONT>

<p><BR>
<h2><a name="submitting">演習 2 : フォームを使用した情報の送信</a></h2>

<p>
イントラネットおよびインターネットのサーバー アプリケーションの一般的な用途は、Web ページにフォームを組み込み､ユーザーの入力を受け入れることです。ASP には Request オブジェクトに QueryString コレクションおよび Form コレクションという 2 つのコレクションがあり、フォームの情報の処理に使用できます。</p>
<p>この演習では、HTML フォームでユーザーの入力を受け入れて、ユーザーの入力を Web サーバーの同じページに送り返す HTML ページを作成します。次に Web サーバーがユーザーの入力を表示します。このモジュールの後ろの箇所で、フォームに関するこの知識を使用して、ASP スクリプトを使用するゲスト ブック アプリケーションを構築します。この演習を完了するには、次に示すタスクを実行します。
</p>

<ul>
    <li>
	<b>例 1&nbsp;&nbsp;&nbsp;</b>フォームにボタン要素の選択を表示します。
    </li>
    <li>
	<b>例 2&nbsp;&nbsp;&nbsp;</b>フォームにテキスト ボックス要素を表示し、フォームからユーザーの入力を受け入れ、Web ページにユーザーの入力を表示します。
	</li>
</ul>

<h3>例 1 : ボタン</h3>

<p>
フォームには、ユーザーがデータの入力に使用できるさまざまな種類の要素を組み込むことができます。この例では、 5 つの入力要素を使います。RADIO ボタン、SUBMIT ボタン、RESET ボタン、CHECKBOX ボタン、および TEXT ボタンなど多くの種類のボタンがあります。
</p>
<p>ユーザーがフォームに情報を入力した後、情報を Web アプリケーションに送信する必要があります。&nbsp;ユーザーが Web ページの &quot;Submit&quot; というラベルが付いたボタンをクリックすると、フォームのデータはクライアントから Form タグの ACTION 要素に示された Web ページに送信されます。この Web ページは呼び出し元のページと同じである必要はありません。この例では、ACTION 要素に示された Web ページは呼び出し元のページと同じで、別のページを呼び出す必要はありません。
</p>
<p>この例では、METHOD=&quot;POST&quot; を使用して、Web クライアントのブラウザから Web サーバーにデータを送信します。フォームで METHOD=&quot;POST&quot; を使用する場合、ユーザーのデータは、Request オブジェクトの Form コレクションで処理されます。
</p>

<p>
次に示すコードをコピーし、テキスト エディタで新しいファイルに貼り付け、Button.asp と名前を付けて <i>x</i>:\Inetpub\Wwwroot\Tutorial ディレクトリに保存します。アドレス バーに「http://localhost/Tutorial/Button.asp」と入力し、ブラウザでこの例を表示します。
</p>  

<code>
<p>
&nbsp; &lt;%@ Language=VBScript %&gt;
<BR>
<BR>&nbsp; &lt;html&gt; 
<BR>&nbsp; &lt;head&gt; 
<BR>&nbsp; &lt;title&gt;Button Form&lt;/title&gt; 
<BR>&nbsp; &lt;/head&gt; 
<BR>&nbsp; &lt;body&gt; 
<BR>&nbsp; &lt;font face="MS Gothic"&gt; 
<BR>
<BR>&nbsp; &lt;FORM NAME="Button Example" METHOD="POST" ACTION="button.asp"&gt;
<BR>&nbsp; &lt;H3&gt;Computer Programming Experience:&lt;/H3&gt; 
<BR>&nbsp; &lt;p&gt;
<BR>&nbsp; &lt;INPUT TYPE="RADIO" NAME= "choice" VALUE="Less than 1"&gt; Less than 1 year.&lt;BR&gt; 
<BR>&nbsp; &lt;INPUT TYPE="RADIO" NAME= "choice" VALUE="1 to 5"&gt; 1-5 years.&lt;BR&gt;
<BR>&nbsp; &lt;INPUT TYPE="RADIO" NAME= "choice" VALUE="More than 5"&gt; More than 5 years.&lt;BR&gt;
<BR>&nbsp; &lt;/p&gt; 
<BR>&nbsp; &lt;p&gt;
<BR>&nbsp; &lt;INPUT TYPE="SUBMIT" VALUE=&quot;Submit&quot;&gt; 
<BR>&nbsp; &lt;INPUT TYPE="RESET" VALUE="Clear Form"&gt;
<BR>&nbsp; &lt;/p&gt;
<BR>&nbsp; &lt;/form&gt; 
<BR>
<BR>&nbsp; &lt;%
<BR>&nbsp;&nbsp; 'Check to see if input has already been entered.&nbsp;
<BR>&nbsp;&nbsp; dim strChoice
<BR>&nbsp;&nbsp; strChoice = Request.Form(&quot;choice&quot;)
<BR>
<BR>&nbsp;&nbsp; If "" = strChoice Then
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;P&gt;(No input yet.)&lt;/P&gt;"
<BR>&nbsp;&nbsp; Else
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;P&gt;Your last choice was &lt;B&gt;" &amp; strChoice &amp; "&lt;/B&gt;&lt;/P&gt;"
<BR>&nbsp;&nbsp; End If
<BR>&nbsp; %&gt;
<BR>
<BR>&nbsp; &lt;/font&gt; 
<BR>&nbsp; &lt;/body&gt; 
<BR>&nbsp; &lt;/html&gt;
</p>
</code>

<P>
ブラウザには、次のように表示されます。
</P>

<FONT face="MS Gothic">
<FORM name="Button Example" method=post>
<H3>&nbsp; Computer Programming Experience:</H3>
<P>
&nbsp; <INPUT type=radio value="Less than 1" name=choice> Less than 1 year.<BR>&nbsp; <INPUT type=radio value="1 to 5" name=choice> 1-5 years.<BR>&nbsp; <INPUT type=radio value="More than 5" name=choice> More than 5 years. <BR>
</P>
<P>
&nbsp; <INPUT id=button1 type=button value=Submit name=button1>
<INPUT id=button2 type=button value="Clear Form" name=button2>
</P>
</FORM>

<P>
&nbsp; (No input yet.)
</P>
</FONT>

<BR>
<h3>例 2 : 入力フォーム要素</h3>

<p>
この例には、テキスト フィールドと呼ばれる 3 つの入力フォーム要素と、チェック ボックスと呼ばれる 2 つの入力フォームがあります。チェック ボックスは複数選択することができるので、オプション ボタンとは異なります。さらに、サーバーにデータを送り返すための既定の [Submit] ボタンも必要です。
<P>この例では、METHOD=GET を使用して、Web クライアントのブラウザから Web サーバーにデータを送信します。フォームで METHOD=GET を使用すると、ユーザーのデータは Request オブジェクトの QueryString コレクションで処理されます。
</p>
<p>[Submit] ボタンをクリックした後に、アドレス バーを見ると、URL の終わりに QueryString の要素が表示されているはずです。
</p>

<p>
次に示すコードをコピーし、テキスト エディタで新しいファイルに貼り付け、Text.asp と名前を付けて <i>x</i>:\Inetpub\Wwwroot\Tutorial ディレクトリに保存します。アドレス バーに「http://localhost/Tutorial/Text.asp」と入力し、ブラウザでこの例を表示します。
</p>

<code>
<p>
&nbsp; &lt;%@ Language=VBScript %&gt;&nbsp; 
<BR>
<BR>&nbsp; &lt;html&gt; 
<BR>&nbsp; &lt;head&gt; 
<BR>&nbsp; &lt;title&gt;Text and Checkbox Form&lt;/title&gt;
<BR>&nbsp; &lt;/head&gt;
<BR>&nbsp; &lt;body&gt;
<BR>&nbsp; &lt;font face=&quot;MS Gothic&quot;&gt;
<BR>
<BR>&nbsp; &lt;FORM NAME=&quot;TextCheckbox Example&quot; METHOD=&quot;GET&quot;
ACTION=&quot;text.asp&quot;&gt;
<BR>&nbsp; &lt;H3&gt;Please fill out this form to get information on our
products:&lt;/H3&gt;
<BR>&nbsp; &lt;p&gt;
<BR>&nbsp; &lt;table&gt;
<BR>&nbsp; &lt;tr&gt;
<BR>&nbsp; &lt;td&gt;&lt;font face=&quot;MS Gothic&quot;&gt;Name
(required)&lt;/td&gt;
<BR>&nbsp; &lt;td&gt;&lt;INPUT TYPE=&quot;TEXT&quot; NAME=&quot;name&quot;
VALUE=&quot;&quot; SIZE=&quot;20&quot; MAXLENGTH=&quot;150&quot;&gt;&lt;/td&gt;
<BR>&nbsp; &lt;/tr&gt;&lt;tr&gt;
<BR>&nbsp; &lt;td&gt;&lt;font face=&quot;MS Gothic&quot;&gt;Company&lt;/td&gt;
<BR>&nbsp; &lt;td&gt;&lt;INPUT TYPE=&quot;TEXT&quot; NAME=&quot;company&quot;
VALUE=&quot;&quot; SIZE=&quot;25&quot; MAXLENGTH=&quot;150&quot;&gt;&lt;/td&gt;
<BR>&nbsp; &lt;/tr&gt;&lt;tr&gt;
<BR>&nbsp; &lt;td&gt;&lt;font face=&quot;MS Gothic&quot;&gt;E-mail
(required)&lt;/td&gt;
<BR>&nbsp; &lt;td&gt;&lt;INPUT TYPE=&quot;TEXT&quot; NAME=&quot;email&quot;
VALUE=&quot;&quot; SIZE=&quot;25&quot; MAXLENGTH=&quot;150&quot;&gt;&lt;/td&gt;
<BR>&nbsp; &lt;/tr&gt;
<BR>&nbsp; &lt;/table&gt;
<BR>&nbsp; &lt;/p&gt;
<BR>&nbsp; &lt;p&gt;
<BR>&nbsp; Requesting information on our:&lt;BR&gt;
<BR>&nbsp; &lt;INPUT TYPE=&quot;CHECKBOX&quot; NAME= &quot;info&quot;
VALUE=&quot;software&quot;&gt;Software&lt;BR&gt;
<BR>&nbsp; &lt;INPUT TYPE=&quot;CHECKBOX&quot; NAME= &quot;info&quot;
VALUE=&quot;hardware&quot;&gt;Hardware &lt;BR&gt;
<BR>&nbsp; &lt;/p&gt;
<BR>&nbsp; &lt;p&gt;
<BR>&nbsp; &lt;INPUT TYPE=&quot;SUBMIT&quot; VALUE=&quot;Submit&quot;&gt;
<BR>&nbsp; &lt;INPUT TYPE=&quot;RESET&quot; VALUE=&quot;Clear Form&quot;&gt;
<BR>&nbsp; &lt;/p&gt;
<BR>&nbsp; &lt;/form&gt;
<BR>
<BR>&nbsp; &lt;%
<BR>&nbsp;&nbsp; 'Check to see if input has already been entered.
<BR>&nbsp;&nbsp; dim strName, strEmail, strCompany, strInfo
<BR>&nbsp;&nbsp; strName = Request.QueryString(&quot;name&quot;)
<BR>&nbsp;&nbsp; strEmail = Request.QueryString(&quot;email&quot;)
<BR>&nbsp;&nbsp; strCompany = Request.QueryString(&quot;company&quot;)
<BR>&nbsp;&nbsp; strInfo = Request.QueryString(&quot;info&quot;)
<BR>
<BR>&nbsp;&nbsp; 'Display what was entered.
<BR>&nbsp;&nbsp; If (&quot;&quot; = strName) OR (&quot;&quot; = strEmail) Then
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Response.Write &quot;&lt;P&gt;(No required input
entered yet.)&lt;/P&gt;&quot;
<BR>&nbsp;&nbsp; Else
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Response.Write &quot;&lt;P&gt;Your are &quot; &amp;
strName
<BR>&nbsp;&nbsp;&nbsp;&nbsp; If Not (&quot;&quot; = strCompany) Then
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write &quot; from &quot; &amp;
strCompany
<BR>&nbsp;&nbsp;&nbsp;&nbsp; End If
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Response.Write &quot;. &lt;BR&gt;Your email address
is &quot; &amp; strEmail
<BR>&nbsp;&nbsp;&nbsp;&nbsp; If Not (&quot;&quot; = strInfo) Then
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write &quot; and you would
like information on &quot; &amp; strInfo &amp; &quot;.&lt;/P&gt;&quot;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; End If
<BR>&nbsp;&nbsp; End If
<BR>&nbsp; %&gt;
<BR>
<BR>&nbsp; &lt;/font&gt;
<BR>&nbsp; &lt;/body&gt;
<BR>&nbsp; &lt;/html&gt;
</p>
</code>

<P>
ブラウザには、次のように表示されます。
</P>

<FONT face="MS Gothic">
<FORM name="Button Example" method=get>
<H3>&nbsp; Please fill out this form to get information about our products:</H3>
<P>
<TABLE>
  <TR>
<TD><FONT face="MS Gothic">&nbsp; Name (required)</FONT></TD>
    <TD><INPUT maxLength=150 name=name></TD></TR>
  <TR>
<TD><FONT face="MS Gothic">&nbsp; Company</FONT></TD>
    <TD><INPUT maxLength=150 size=25 name=company></TD></TR>
  <TR>
<TD><FONT face="MS Gothic">&nbsp; E-mail (required)</FONT></TD>
    <TD><INPUT size=25 name="email" MAXLENGTH="150"></TD>
  </TR>
</TABLE>
</P>
<P>&nbsp; Requesting information about our:<BR>&nbsp; <INPUT type=checkbox value=software name=info>Software <BR>&nbsp; <INPUT type=checkbox value=hardware name=info>Hardware 
</P>
<P>&nbsp; <INPUT id=button3 type=button value=Submit name=button3>
<INPUT id=button4 type=button value="Clear Form" name=button4>
</P>
</FORM>
<P>
&nbsp; (No required input entered yet.)
</P>
</FONT>
<p>
<BR><h2><a name="creating">演習 3 : データベースを使用したゲスト ブックの作成</a></h2>

<p>この演習には、システムに Microsoft Access がインストールされていることが必要です。64 ビット プラットフォームに対応した Access が開発されるまでは 64 ビット プラットフォームではサポートされません。</p>
<p>演習 3 では、ゲスト ブック アプリケーションを開発します。ゲスト ブックによつて、Web サイトの利用者は、名前、電子メール アドレス、コメントなどの情報を残すことができます。この演習では、Access データベースを作成した後に次に示すタスクを実行します。
</p>

<ul>
    <li>
<b>例 1</b>&nbsp;&nbsp; ADO Connection オブジェクトのみを使用してデータベースに接続する ASP ページを作成します。 
    </li>
    <li>
<b>例 2</b>&nbsp;&nbsp; Connection オブジェクトと Command オブジェクトを一緒に使用してデータベースに接続する ASP ページを作成します。
    </li>     
    <li>
<b>例 3</b>&nbsp;&nbsp; データベースのゲスト ブック情報をブラウザに表示する ASP ページを作成します。
    </li>     
</ul>

<br><h4>Access データベースの作成</h4>

<p>
GuestBook.mdb という Access データベースを作成し、<i>x</i>:\Inetpub\Wwwroot\Tutorial に保存します。GuestBook というテーブルをデータベースに作成します。Access の ［デザイン ビューでテーブルを作成する］ オプションを選択し、次に示すフィールドとプロパティを追加します。
</p>

<p>
<table border=1 align=center cellspacing=1 cellpadding=5>
<tr>
<td align="left" valign="top"><B>フィールド名</B></td>
<td align="left" valign="top"><B>データ型</B></td>
<td align="left" valign="top"><B>標準のフィールド プロパティ</B></td>
</tr><tr>
<td align="left" valign="top">FID</td>
<td align="left" valign="top">オートナンバー型</td>
<td align="left" valign="top">フィールド サイズ = 長整数型、<BR>新規レコードの値 = インクリメント、<BR>インデックス = はい (重複なし)</td>
</tr><tr>
<td align="left" valign="top">FTB1</td>
<td align="left" valign="top">テキスト型</td>
<td align="left" valign="top">フィールド サイズ = 255、<BR>値要求 = いいえ、<BR>空文字列の許可 = はい、<BR>インデックス = いいえ</td>
</tr><tr>
<td align="left" valign="top">FTB2</td>
<td align="left" valign="top">テキスト型</td>
<td align="left" valign="top">フィールド サイズ = 255、<BR>値要求 = いいえ、<BR>空文字列の許可 = はい、<BR>インデックス = いいえ</td>
</tr><tr>
<td align="left" valign="top">FTB3</td>
<td align="left" valign="top">テキスト型</td>
<td align="left" valign="top">フィールド サイズ = 255、<BR>値要求 = いいえ、<BR>空文字列の許可 = はい、<BR>インデックス = いいえ</td>
</tr><tr>
<td align="left" valign="top">FTB4</td>
<td align="left" valign="top">テキスト型</td>
<td align="left" valign="top">フィールド サイズ = 255、<BR>値要求 = いいえ、<BR>空文字列の許可 = はい、<BR>インデックス = いいえ</td>
</tr><tr>
<td align="left" valign="top">FMB1</td>
<td align="left" valign="top">Memo</td>
<td align="left" valign="top">値要求 = いいえ、<BR>空文字列の許可 = はい</td>
</tr>
</table>

<BR><h4>Access データベースにデータを追加する ASP ページの作成</h4>

<p>
データベースを作成したら、ASP ページを構築できます。この ASP ページでは、データベースに接続し、Microsoft ActiveX&reg; Data Objects (ADO) を使用して入力されたデータを読み取ります。ADO は、ほとんどすべての種類のデータベースのデータを処理できるメソッドとプロパティを持つオブジェクトのコレクションです(データベースを頻繁に使用する場合は、プログラマ用の ADO のリファレンス ブックを購入してください。以降の例では、データベースを開き、読み込み、および書き込むのに必要な基本的な ADO コードの例のみを示しています)。&nbsp;
</p>

<p>
次の 2 つの例では同じ結果が生成されます。ただし、最初の例では Connection オブジェクトのみを使用し、2 番目の例ではより強力な Command オブジェクトがジョブの一部を実行します。2 つの例を比較し、オブジェクトがどのように接続されるのかを調べます。オブジェクトについて理解できたら、ADO のプログラマ用リファレンスを使用して、より多くのメソッドおよびプロパティを使用してみてください。
</p>

<p>ASP ページでの ADO エラーの例を見るには、データベースの名前を変更したり、接続文字列に誤った入力をしたり、データベースを読み取り専用にした後に、ページを閲覧します。
</p>

<BR><h3> 例 1 : ADO Connection オブジェクトのみの使用

</h3>

<p>
次に示すコードをコピーし、テキスト エディタで新しいファイルに貼り付け、GuestBook1.asp と名前を付けて <i>x</i>:\Inetpub\Wwwroot\Tutorial ディレクトリに保存します。アドレス バーに「http://localhost/Tutorial/GuestBook1.asp」と入力し、ブラウザでこの例を表示します。
</p>

<code>
<p>
&nbsp; &lt;%@ Language=VBScript %&gt;
<BR>
<BR>&nbsp; &lt;html&gt;
<BR>&nbsp; &lt;head&gt;
<BR>&nbsp; &lt;title&gt;Guest Book Using Connection Object Only&lt;/title&gt;
<BR>&nbsp; &lt;/head&gt;
<BR>&nbsp; &lt;body&gt;
<BR>&nbsp; &lt;font face=&quot;MS Gothic&quot;&gt;
<BR>&nbsp; &lt;h2&gt;Guest Book Using Connection Object Only&lt;/h2&gt;
<BR>
<BR>&nbsp; &lt;%
<BR>&nbsp;&nbsp; If Not Request.QueryString("Message") = "True" Then
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'No information has been input yet, so provide the form.
<BR>&nbsp; %&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;p&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;FORM NAME=&quot;GuestBook1&quot; METHOD="GET" ACTION="guestbook1.asp"&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;table&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;From:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE="TEXT" NAME="From"&gt;&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;&lt;tr&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;E-mail Address:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE="TEXT" NAME="EmailAdd"&gt;&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;&lt;tr&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;CC:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE="TEXT" NAME="CC"&gt;&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;&lt;tr&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE="TEXT" NAME="Subject"&gt;&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Message:&lt;br&gt;&lt;TEXTAREA NAME="Memo" ROWS=6 COLS=70&gt;&lt;/TEXTAREA&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt;
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;p&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;INPUT TYPE="HIDDEN" NAME="Message" VALUE="True"&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;INPUT TYPE="SUBMIT" VALUE="Submit Information"&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;/FORM&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt;
<BR>&nbsp; &lt;% 
<BR>&nbsp;&nbsp; Else
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'The HIDDEN button above sets the Message variable to True.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'We know now that form data has been entered.
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Get the data from the form. We will be inserting it into the database.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Access doesn't like some characters, such as single-quotes, so encode the
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ' data using the HTMLEncode method of the ASP Server object.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; dim strTB1, strTB2, strTB3, strTB4, strMB1, strCommand
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strTB1 = Server.HTMLEncode(Request.QueryString("From"))
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strTB2 = Server.HTMLEncode(Request.QueryString("EMailAdd"))
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strTB3 = Server.HTMLEncode(Request.QueryString("CC"))
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strTB4 = Server.HTMLEncode(Request.QueryString("Subject"))
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strMB1 = Server.HTMLEncode(Request.QueryString("Memo"))
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'This is a connection string.  ADO uses it to connect to a database through the Access driver.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'It needs the provider name of the Access driver and the name of the Access database.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Connection strings are slightly different, depending on the provider being used, 
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ' but they all use semicolons to separate variables.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'If this line causes and error, search in your registry for
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ' Microsoft.JET to see if 4.0 is your version.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strProvider = "Provider=Microsoft.JET.OLEDB.4.0;Data Source=C:\InetPub\Wwwroot\Tutorial\guestbook.mdb;"
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'This creates an instance of an ADO Connection object.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'There are 4 other ADO objects available to you, each with different methods and
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'properties that allow you to do almost anything with database data.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Set objConn = server.createobject("ADODB.Connection")
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'The Open method of the Connection object uses the connection string to
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ' create a connection to the database.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; objConn.Open strProvider
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Define the query.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'There are many types of queries, allowing you to add, remove, or get data.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'This query will add your data into the database, using the INSERT INTO key words.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Here, GuestBook is the name of the table.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'You need single-quotes around strings here.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strCommand = "INSERT INTO GuestBook (FTB1,FTB2,FTB3,FTB4,FMB1) VALUES ('"
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strCommand = strCommand & strTB1 & "','" & strTB2 & "','" & strTB3 & "','" & strTB4 & "','" & strMB1
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strCommand = strCommand & "')"
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Execute the query to add the data to the database.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; objConn.Execute strCommand
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Response.Write("Thank you! Your data has been added.")
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; End If
<BR>&nbsp; %&gt;
<BR>
<BR>&nbsp; &lt;/font&gt;<BR>&nbsp; &lt;/body&gt;
<BR>&nbsp; &lt;/html&gt;
</p>
</code>

<P>
ブラウザには、次のように表示されます。
</P>

<p>
  <font face="MS Gothic"> 
<h2>&nbsp; Guest Book Using Connection Object Only</h2> 
     <p> 
     <FORM NAME="guestbook" METHOD="POST"> 
     <table> 
       <tr> 
<td><font face="MS Gothic">&nbsp; From:</td><td><INPUT TYPE="TEXT" NAME="From"></td> 
       </tr><tr> 
<td><font face="MS Gothic">&nbsp; E-mail Address:</td><td><INPUT TYPE="TEXT" NAME="EmailAdd"></td> 
       </tr><tr> 
<td><font face="MS Gothic">&nbsp; CC:</td><td><INPUT TYPE="TEXT" NAME="CC"></td> 
       </tr><tr> 
<td><font face="MS Gothic">&nbsp; Subject:</td><td><INPUT TYPE="TEXT" NAME="Subject"></td> 
       </tr> 
     </table> 
&nbsp; Message:<br>&nbsp; <TEXTAREA NAME="Memo" ROWS=6 COLS=70></TEXTAREA> 
     <p> 
&nbsp; <INPUT TYPE="BUTTON" VALUE="Submit Information"> 
     </FORM> 
  </font>

<BR>
<h3> 例 2 : Connection オブジェクトと Command オブジェクトを一緒に使用</h3>

<p>
次に示すコードをコピーし、テキスト エディタで新しいファイルに貼り付け、GuestBook2.asp と名前を付けて <i>x</i>:\Inetpub\Wwwroot\Tutorial ディレクトリに保存します。アドレス バーに「http://localhost/Tutorial/GuestBook2.asp」と入力し、ブラウザでこの例を表示します。
</p>

<code>
<p>
&nbsp; &lt;%@ Language=VBScript %&gt;
<BR>
<BR>&nbsp; &lt;html&gt;
<BR>&nbsp; &lt;head&gt;
<BR>&nbsp; &lt;title&gt;Guest Book Using Connection Object and Command Object&lt;/title&gt;
<BR>&nbsp; &lt;/head&gt;
<BR>&nbsp; &lt;body&gt;
<BR>&nbsp; &lt;font face=&quot;MS Gothic&quot;&gt;
<BR>&nbsp; &lt;h2&gt;Guest Book Using Connection Object and Command Object&lt;/h2&gt;
<BR>
<BR>&nbsp; &lt;%
<BR>&nbsp;&nbsp; If Not Request.QueryString("Message") = "True" Then
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'No information has been input yet, so provide the form.
<BR>&nbsp; %&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;p&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;FORM NAME=&quot;GuestBook2&quot; METHOD="GET" ACTION="guestbook2.asp"&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;table&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;From:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE="TEXT" NAME="From"&gt;&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;&lt;tr&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;E-mail Address:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE="TEXT" NAME="EmailAdd"&gt;&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;&lt;tr&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;CC:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE="TEXT" NAME="CC"&gt;&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;&lt;tr&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE="TEXT" NAME="Subject"&gt;&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Message:&lt;br&gt;&lt;TEXTAREA NAME="Memo" ROWS=6 COLS=70&gt;&lt;/TEXTAREA&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt;
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;p&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;INPUT TYPE="HIDDEN" NAME="Message" VALUE="True"&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;INPUT TYPE="SUBMIT" VALUE="Submit Information"&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;/FORM&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt;
<BR>&nbsp; &lt;% 
<BR>&nbsp;&nbsp; Else
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'The HIDDEN button above sets the Message variable to True.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'We know now that form data has been entered.
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Get the data from the form. We will be inserting it into the database.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Access doesn't like some characters, such as single-quotes, so encode the
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ' data using the HTMLEncode method of the ASP Server object.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; dim strTB1, strTB2, strTB3, strTB4, strMB1
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strTB1 = Server.HTMLEncode(Request.QueryString("From"))
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strTB2 = Server.HTMLEncode(Request.QueryString("EMailAdd"))
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strTB3 = Server.HTMLEncode(Request.QueryString("CC"))
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strTB4 = Server.HTMLEncode(Request.QueryString("Subject"))
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strMB1 = Server.HTMLEncode(Request.QueryString("Memo"))
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'The Memo data type in the Access database allows you to set the field size.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; If strMB1 = "" Then
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iLenMB1 = 255
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Else
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iLenMB1 = Len(strMB1)
<BR>&nbsp;&nbsp;&nbsp;&nbsp; End If
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'This is a connection string.  ADO uses it to connect to a database through the Access driver.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'It needs the provider name of the Access driver and the name of the Access database.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Connection strings are slightly different, depending on the provider being used, 
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ' but they all use semicolons to separate variables.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'If this line causes and error, search in your registry for
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ' Microsoft.JET to see if 4.0 is your version.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; strProvider = "Provider=Microsoft.JET.OLEDB.4.0;Data Source=C:\InetPub\Wwwroot\Tutorial\guestbook.mdb;"
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'This creates an instance of an ADO Connection object.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'There are 4 other ADO objects available to you, each with different methods and
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'properties that allow you to do almost anything with database data.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Set objConn = server.createobject("ADODB.Connection")
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'The Open method of the Connection object uses the connection string to
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ' create a connection to the database.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; objConn.Open strProvider
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'This creates an instance of an ADO Command object.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Although you could do most of your work with the Connection object,
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ' the Command object gives you more control.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Set cm = Server.CreateObject("ADODB.Command")
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'The ActiveConnection property allows you to attach to an Open connection.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'This is how you link the Connection object above to the Command object.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; cm.ActiveConnection = objConn
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Define the query.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'There are many types of queries, allowing you to add, remove, or get data.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'This query will add your data into the database, using the INSERT INTO keywords.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Because we are using the Command object, we need to put our query into the
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ' CommandText property.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Here, GuestBook is the name of the table.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; cm.CommandText = "INSERT INTO GuestBook (FTB1,FTB2,FTB3,FTB4,FMB1) VALUES (?,?,?,?,?)"
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'This is where you see the power of the Command object.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'By putting ? marks in the string above, we can use the Parameters collection
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ' to have ADO fill in the ? with the detailed parameters below.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'cm.CreateParameter formats the parameter for you.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'cm.Parameters.Append appends the parameter to the collection.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Make sure they are in the same order as (TB1,TB2,TB3,TB4,MB1).
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Set objparam = cm.CreateParameter(, 200, , 255, strTB1)
<BR>&nbsp;&nbsp;&nbsp;&nbsp; cm.Parameters.Append objparam
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Set objparam = cm.CreateParameter(, 200, , 255, strTB2)
<BR>&nbsp;&nbsp;&nbsp;&nbsp; cm.Parameters.Append objparam
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Set objparam = cm.CreateParameter(, 200, , 255, strTB3)
<BR>&nbsp;&nbsp;&nbsp;&nbsp; cm.Parameters.Append objparam
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Set objparam = cm.CreateParameter(, 200, , 255, strTB4)
<BR>&nbsp;&nbsp;&nbsp;&nbsp; cm.Parameters.Append objparam
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Set objparam = cm.CreateParameter(, 201, , iLenMB1, strMB1)
<BR>&nbsp;&nbsp;&nbsp;&nbsp; cm.Parameters.Append objparam
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Execute the query to add the data to the database.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Here, the Execute method of the Command object is called instead of
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ' the Execute method of the Connection object.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; cm.Execute
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Response.Write("Thank you! Your data has been added.")
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; End If
<BR>&nbsp; %&gt;
<BR>
<BR>&nbsp; &lt;/font&gt;<BR>&nbsp; &lt;/body&gt;
<BR>&nbsp; &lt;/html&gt;
</p>
</code>

<P>
ブラウザには、次のように GuestBook1.asp と同じコンテンツが表示されます。
</P>
<p>
  <font face="MS Gothic"> 
<h2>&nbsp; Guest Book Using Connection Object Only</h2> 
     <p> 
     <FORM NAME="guestbook" METHOD="POST"> 
     <table> 
       <tr> 
<td><font face="MS Gothic">&nbsp; From:</td><td><INPUT TYPE="TEXT" NAME="From"></td> 
       </tr><tr> 
<td><font face="MS Gothic">&nbsp; E-mail Address:</td><td><INPUT TYPE="TEXT" NAME="EmailAdd"></td> 
       </tr><tr> 
<td><font face="MS Gothic">&nbsp; CC:</td><td><INPUT TYPE="TEXT" NAME="CC"></td> 
       </tr><tr> 
<td><font face="MS Gothic">&nbsp; Subject:</td><td><INPUT TYPE="TEXT" NAME="Subject"></td> 
       </tr> 
     </table> 
&nbsp; Message:<br>&nbsp; <TEXTAREA NAME="Memo" ROWS=6 COLS=70></TEXTAREA> 
     <p> 
&nbsp; <INPUT TYPE="BUTTON" VALUE="Submit Information"> 
     </FORM> 
  </font> <br>
<h3>例 3 : ブラウザでのデータベースの表示</h3>

<p>データベースに情報を入力したら、別のスクリプトを含む Web ページを使用してデータを表示したり編集することができます。 クエリの定義方法以外は ADO コードに大きな変更はありません。<BR>上の 2 つの例では、INSERT INTO クエリを使用してデータベースにレコードを追加しました。この例では、SELECT クエリを使用して、データベースからレコードを選択し、ブラウザに表示します。また、DELETE クエリを使用してデータベースからレコードを削除します。この例で使用しないクエリは、UPDATE クエリだけです。このクエリの構文は、INSERT INTO クエリの構文に似ています。UPDATE クエリを使用すると、データベースのフィールドを変更できます。
</p>

<p>
次に示すコードをコピーし、テキスト エディタで新しいファイルに貼り付け、ViewGB.asp と名前を付けて <i>x</i>:\Inetpub\Wwwroot\Tutorial ディレクトリに保存します。アドレス バーに「http://localhost/Tutorial/VIewGB.asp」<BR>と入力し、ブラウザでこの例を表示します。
</p>

<code>
<p>
&nbsp; &lt;%@ Language=VBScript %&gt; 
<BR>
<BR>&nbsp; &lt;html&gt; 
<BR>&nbsp; &lt;head&gt; 
<BR>&nbsp; &lt;title&gt;View Guest Book&lt;/title&gt; 
<BR>&nbsp; &lt;/head&gt; 
<BR>&nbsp; &lt;body&gt; 
<BR>&nbsp; &lt;font face=&quot;MS Gothic&quot;&gt; 
<BR>&nbsp; &lt;h2&gt;View Guest Book&lt;/h2&gt; 
<BR>
<BR>&nbsp; &lt;%
<BR>&nbsp; 'Read in any user input. Any of these can be empty.
<BR>&nbsp; 'By doing this first, we can preserve the user input in the form.
<BR>&nbsp; dim strTB1, strTB2, strTB3, strTB4, strMB1, strSort, iDelete
<BR>&nbsp; strTB1 = Server.HTMLEncode(Request.QueryString("From")) 
<BR>&nbsp; strTB2 = Server.HTMLEncode(Request.QueryString("EMailAdd")) 
<BR>&nbsp; strTB3 = Server.HTMLEncode(Request.QueryString("CC")) 
<BR>&nbsp; strTB4 = Server.HTMLEncode(Request.QueryString("Subject")) 
<BR>&nbsp; strMB1 = Server.HTMLEncode(Request.QueryString("Memo")) 
<BR>&nbsp; strSort = Server.HTMLEncode(Request.QueryString("sort"))
<BR>&nbsp; iDelete = CInt(Request.QueryString("Delete"))
<BR>
<BR>&nbsp; 'Because we use this variable, and it might not be set...
<BR>&nbsp; If "" = strSort Then
<BR>&nbsp;&nbsp;&nbsp; strSort = "FID"
<BR>&nbsp; End If
<BR>&nbsp; %&gt;
<BR>
<BR>&nbsp; &lt;p&gt; 
<BR>&nbsp; &lt;FORM NAME=&quot;ViewGuestBook&quot; METHOD="GET" ACTION="viewgb.asp"&gt; 
<BR>&nbsp; &lt;table&gt;
<BR>&nbsp;&nbsp;&nbsp; &lt;tr&gt;
<BR>&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;Sort by which column:&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;SELECT NAME="sort" SIZE="1"&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;OPTION VALUE="FID"&gt;ID Number&lt;/OPTION&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;OPTION VALUE="FTB1"&gt;Name&lt;/OPTION&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;OPTION VALUE="FTB2"&gt;Email&lt;/OPTION&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;OPTION VALUE="FTB3"&gt;CC&lt;/OPTION&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;OPTION VALUE="FTB4"&gt;Subject&lt;/OPTION&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;OPTION VALUE="FMB1"&gt;Memo&lt;/OPTION&gt;
<BR>&nbsp;&nbsp;&nbsp; &lt;/SELECT&gt;&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp; &lt;/tr&gt;&lt;tr&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;Name Contains:&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;INPUT TYPE="TEXT" NAME="From" VALUE="&lt;%=strTB1%&gt;"&gt;&lt;/td&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;/tr&gt;&lt;tr&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;E-mail Address Contains:&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;INPUT TYPE="TEXT" NAME="EmailAdd" VALUE="&lt;%=strTB2%&gt;"&gt;&lt;/td&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;/tr&gt;&lt;tr&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;CC Contains:&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;INPUT TYPE="TEXT" NAME="CC" VALUE="&lt;%=strTB3%&gt;"&gt;&lt;/td&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;/tr&gt;&lt;tr&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;Subject Contains:&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;INPUT TYPE="TEXT" NAME="Subject" VALUE="&lt;%=strTB4%&gt;"&gt;&lt;/td&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;/tr&gt;&lt;tr&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;font face="MS Gothic"&gt;Memo Contains:&lt;/td&gt;
<BR>&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;INPUT TYPE="TEXT" NAME="Memo" VALUE="&lt;%=strMB1%&gt;"&gt;&lt;/td&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;/tr&gt; 
<BR>&nbsp; &lt;/table&gt; 
<BR>&nbsp; &lt;INPUT TYPE="SUBMIT" VALUE="Submit Search Parameters"&gt;
<BR>&nbsp; &lt;/p&gt; 
<BR>
<BR>&nbsp; &lt;%
<BR>&nbsp; 'Create your connection string, create an instance of the Connection object,
<BR>&nbsp; ' and connect to the database.
<BR>&nbsp; strProvider = "Provider=Microsoft.JET.OLEDB.4.0;Data Source=C:\InetPub\Wwwroot\Tutorial\guestbook.mdb;" 
<BR>&nbsp; Set objConn = Server.CreateObject("ADODB.Connection") 
<BR>&nbsp; objConn.Open strProvider 
<BR> 
<BR>&nbsp; 'Define the query. 
<BR>&nbsp; If iDelete = 0 Then
<BR>&nbsp;&nbsp;&nbsp; 'If the Delete variable is not set, the query is a SELECT query.
<BR>&nbsp;&nbsp;&nbsp; '* means all fields. ASC means ASCII. % is a wildcard character.
<BR>&nbsp;&nbsp;&nbsp; strQuery = "SELECT * FROM GuestBook"
<BR>&nbsp;&nbsp;&nbsp; strQuery = strQuery & " WHERE FTB1 LIKE '%" & strTB1 & "%'"
<BR>&nbsp;&nbsp;&nbsp; strQuery = strQuery & " AND FTB2 LIKE '%" & strTB2 & "%'"
<BR>&nbsp;&nbsp;&nbsp; strQuery = strQuery & " AND FTB3 LIKE '%" & strTB3 & "%'"
<BR>&nbsp;&nbsp;&nbsp; strQuery = strQuery & " AND FTB4 LIKE '%" & strTB4 & "%'"
<BR>&nbsp;&nbsp;&nbsp; strQuery = strQuery & " AND FMB1 LIKE '%" & strMB1 & "%'"
<BR>&nbsp;&nbsp;&nbsp; strQuery = strQuery & " ORDER BY " & StrSort & " ASC"
<BR>&nbsp; Else
<BR>&nbsp;&nbsp;&nbsp; 'We want to delete a record.
<BR>&nbsp;&nbsp;&nbsp; strQuery = "DELETE FROM GuestBook WHERE FID=" & iDelete
<BR>&nbsp; End If
<BR>
<BR>&nbsp; 'Executing the SELECT query creates an ADO Recordset object.
<BR>&nbsp; 'This holds the data you get from the database.
<BR>&nbsp; Set objRS = objConn.Execute(strQuery)
<BR>
<BR>&nbsp; 'Now that you have the database data stored in the Recordset object,
<BR>&nbsp; ' show it in a table.
<BR>&nbsp;%&gt;
<BR>
<BR>&nbsp; &lt;p&gt;
<BR>&nbsp; &lt;FORM NAME=&quot;EditGuestBook&quot; METHOD="GET" ACTION="viewgb.asp"&gt; 
<BR>&nbsp; &lt;table border=1 cellpadding=4 &gt;
<BR>&nbsp; &lt;% 
<BR>&nbsp;&nbsp;&nbsp; On Error Resume Next
<BR>
<BR>&nbsp;&nbsp;&nbsp; If objRS.EOF Then 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If iDelete = 0 Then
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;tr&gt;&lt;td&gt;&lt;font
face=&amp;quot;MS Gothic&amp;quot;&gt;There are no entries in the database.&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;" 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;tr&gt;&lt;td&gt;&lt;font
face=&amp;quot;MS Gothic&amp;quot;&gt;Record " & iDelete & " was deleted.&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;"
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
<BR>&nbsp;&nbsp;&nbsp; Else
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Print out the field names using some of the methods and properties
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' of the Recordset object.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;tr&gt;"
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'For each column in the current row...
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For i = 1 to (objRS.Fields.Count - 1)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          '&nbsp;write out the field name.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;td&gt;&lt;font
face=&amp;quot;MS Gothic&amp;quot;&gt;&lt;B&gt;" & objRS(i).Name & "&lt;/B&gt;&lt;/font&gt;&lt;/td&gt;"
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;td&gt;&lt;font face=&amp;quot;MS
Gothic&amp;quot;&gt;&lt;B&gt;Delete&lt;/B&gt;&lt;/font&gt;&lt;/td&gt;"
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;/tr&gt;"
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Print out the field data, using some other methods and properties
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' of the Recordset object. When you see a pattern in how they are used,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' you can look up others and experiment.
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'While not at the end of the records in the set...
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; While Not objRS.EOF
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;tr&gt;"
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'For each column in the current row...
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For i = 1 to (objRS.Fields.Count - 1)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;write out the data in the field.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;td&gt;&lt;font
face=&amp;quot;MS Gothic&amp;quot;&gt;" & objRS(i) & "&lt;/font&gt;&lt;/td&gt;"
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Add a button that will pass in an ID number to delete a record.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %&gt;&lt;td&gt;&lt;INPUT TYPE="SUBMIT" NAME="Delete" VALUE="&lt;%=objRS(0)%&gt;"&gt;&lt;/td&gt;&lt;%
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;/tr&gt;"
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Move to the next row.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; objRS.MoveNext
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Wend
<BR>
<BR>&nbsp;&nbsp;&nbsp; End If&nbsp;&nbsp; 'objRS.EOF 
<BR>&nbsp; %&gt; 
<BR>&nbsp; &lt;/table&gt; 
<BR>&nbsp; &lt;/FORM&gt; 
<BR>
<BR>&nbsp; &lt;%
<BR>&nbsp; 'Close the Connection.
<BR>&nbsp; objConn.Close
<BR>&nbsp; %&gt;
<BR>
<BR>&nbsp; &lt;/font&gt;
<BR>&nbsp; &lt;/body&gt; 
<BR>&nbsp; &lt;/html&gt; 
</p>
</code>

<P>
ブラウザには、次のように表示されます。
</P>

<p>
  <font face="MS Gothic"> 
<h2>&nbsp; View Guest Book</h2> 
  <p> 
  <FORM NAME="viewguestbook" METHOD="GET"> 
  &nbsp; <table> 
    <tr> 
<td><font face="MS Gothic">&nbsp; Sort by which column:</td> 
    <td>&nbsp; <SELECT NAME="sort" SIZE="1"> 
<OPTION VALUE="FID">ID Number</OPTION> 
<OPTION VALUE="FTB1">Name</OPTION> 
<OPTION VALUE="FTB2">Email</OPTION> 
<OPTION VALUE="FTB3">CC</OPTION> 
<OPTION VALUE="FTB4">Subject</OPTION> 
<OPTION VALUE="FMB1">Memo</OPTION> 
    </SELECT></td> 
    </tr><tr> 
<td>&nbsp; <font face="MS Gothic">Name Contains:</td> 
    <td><INPUT TYPE="TEXT" NAME="From" VALUE=""></td> 
    </tr><tr> 
<td>&nbsp; <font face="MS Gothic">E-mail Address Contains:</td> 
    <td><INPUT TYPE="TEXT" NAME="EmailAdd" VALUE=""></td> 
    </tr><tr> 
<td>&nbsp; <font face="MS Gothic">CC Contains:</td> 
    <td><INPUT TYPE="TEXT" NAME="CC" VALUE=""></td> 
    </tr><tr> 
<td>&nbsp; <font face="MS Gothic">Subject Contains:</td> 
    <td><INPUT TYPE="TEXT" NAME="Subject" VALUE=""></td> 
    </tr><tr> 
<td>&nbsp; <font face="MS Gothic">Memo Contains:</td> 
    <td><INPUT TYPE="TEXT" NAME="Memo" VALUE=""></td> 
    </tr> 
  </table> 
&nbsp; <INPUT TYPE="BUTTON" VALUE="Submit Search Parameters"> 
  </p> 
  <p> 
  <FORM NAME="editguestbook" METHOD="GET"> 
  &nbsp; <table border=1 cellpadding=4> 
<tr><td><font face="MS Gothic">&nbsp; There are no entries in the database.</font></td></tr> 
  </table> 
  </FORM> 
  </font> 

<P><BR><h2><a name="displaying">演習 4 : Excel スプレッドシートの表示</a></h2>
<p>この演習には、システムに Microsoft Excel がインストールされていることが必要です。64 ビット プラットフォームに対応した Excel が開発されるまでは 64 ビット プラットフォームではサポートされません。</p>
<p>この演習では、Web ページに Microsoft Excel スプレッドシートを表示する方法を示します。前の演習と同様に、ADO を使用します。ただし、この演習では、Access データベースではなく Excel スプレッドシートに接続します。
</p>

<H4>Active Server Page で表示する Excel スプレッドシートの準備</H4>

<ol>
    <li>
	Excel 98 または Excel 2000 のいずれかを使用して、スプレッドシートを作成し、ASPTOC.xls と名前を付けて <i>x</i>:\Inetpub\Wwwroot\Tutorial に保存します。スプレッドシートを作成する際は、特別な書式や列ラベルを使用しないでください。
    </li><li>
	いくつかのフィールドにランダムなデータを入力します。最初の行のセルは、列の名前として扱います。
    </li><li>
	Web ページに表示する、スプレッドシートの行および列を強調表示します(フィールドの 1 つをクリックしてマウスを斜め方向にドラッグし、フィールドのブロックを強調表示します)。
    </li><li>
[挿入] メニューの [名前] をポイントし、[定義] をクリックします。これによって、ワークブックすべてが名前とセルの範囲によって定義されます。
    </li><li>
強調表示されているセル範囲が下部に正しく表示されていることを確認します。ワークブックの名前「MYBOOK」を入力し、[追加] をクリックします。MYBOOK を変更するたびに、[名前の定義] ウィンドウの下部にある [参照範囲] ボックスに正しいセル範囲が表示されていることを確認します。新しいセルのブロックを強調表示した後に MYBOOK を選択するだけでは、セル範囲は更新されません。
    </li><li>
ワークブックの一覧に名前が表示されたら、[OK] をクリックします。スプレッドシートを保存します。
    </li><li>
Excel を終了してファイルのロックを解除し、ASP ページからアクセスできるようにします。
    </li>
</ol>

<p>
演習 3 の例では、接続文字列に、特定の ADO DLL にマップされるプロバイダ名を指定しました。この例では、ドライバ名を使用して、ASP がそのドライバ名の既定のプロバイダを使用するようにします。
</p>

<p>
次に示すコードをコピーし、テキスト エディタで新しいファイルに貼り付け、ViewExcel.asp と名前を付けて <i>x</i>:\Inetpub\Wwwroot\Tutorial ディレクトリに保存します。アドレス バーに「http://localhost/Tutorial/ViewExcel.asp」と入力し、ブラウザでこの例を表示します。
</p>

<code>
<p>
&nbsp; &lt;%@ Language=VBScript %&gt; 
<BR>
<BR>&nbsp; &lt;html&gt; 
<BR>&nbsp; &lt;head&gt; 
<BR>&nbsp; &lt;title&gt;Display an Excel Spreadsheet in a Web Page&lt;/title&gt; 
<BR>&nbsp; &lt;/head&gt; 
<BR>&nbsp; &lt;body&gt;
<BR>&nbsp; &lt;font face=&quot;MS Gothic&quot;&gt; 
<BR>&nbsp; &lt;h2&gt;Display an Excel Spreadsheet in a Web Page&lt;/h2&gt; 
<BR>
<BR>&nbsp; &lt;% 
<BR>&nbsp;&nbsp; 'Create your connection string, create an instance of the Connection object, 
<BR>&nbsp;&nbsp; ' and connect to the database. 
<BR>&nbsp;&nbsp; strDriver = "Driver={Microsoft Excel Driver (*.xls)};DBQ=C:\Inetpub\Wwwroot\Tutorial\ASPTOC.xls;" 
<BR>&nbsp;&nbsp; Set objConn = Server.CreateObject("ADODB.Connection") 
<BR>&nbsp;&nbsp; objConn.Open strDriver 
<BR>
<BR>&nbsp;&nbsp; 'Selects the records from the Excel spreadsheet using the workbook name you saved.
<BR>&nbsp;&nbsp; strSELECT = "SELECT * from `MYBOOK`" 
<BR>
<BR>&nbsp;&nbsp; 'Create an instance of the ADO Recordset object, and connect it to objConn.
<BR>&nbsp;&nbsp; Set objRS = Server.CreateObject("ADODB.Recordset") 
<BR>&nbsp;&nbsp; objRS.Open strSELECT, objConn 
<BR>
<BR>&nbsp;&nbsp; 'Print the cells and rows in the table using the GetString method.
<BR>&nbsp;&nbsp; Response.Write "&lt;H4&gt;Get Excel data in one string with the GetString method&lt;/H4&gt;" 
<BR>&nbsp;&nbsp; Response.Write "&lt;table border=1 &gt;&lt;tr&gt;&lt;td&gt;" 
<BR>&nbsp;&nbsp; Response.Write objRS.GetString (, , "&lt;/td&gt;&lt;td&gt;&lt;font face=&amp;quot;MS Gothic&amp;quot;&gt;", "&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;", NBSPACE) 
<BR>&nbsp;&nbsp; Response.Write "&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;" 
<BR>
<BR>&nbsp;&nbsp; 'Move to the first record.
<BR>&nbsp;&nbsp; objRS.MoveFirst 
<BR>
<BR>&nbsp;&nbsp; 'Print the cells and rows in the table using the ViewGB.asp method.
<BR>&nbsp;&nbsp; Response.Write "&lt;H4&gt;Get Excel data using MoveNext&lt;/H4&gt;" 
<BR>
<BR>&nbsp;&nbsp; 'Print out the field names using some of the methods and properties 
<BR>&nbsp;&nbsp; ' of the Recordset object. 
<BR>&nbsp;&nbsp; Response.Write "&lt;table border=1 &gt;&lt;tr&gt;" 
<BR>
<BR>&nbsp;&nbsp; 'For each column in the current row... 
<BR>&nbsp;&nbsp; For i = 0 to (objRS.Fields.Count - 1) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;write out the field name. 
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;td&gt;&lt;font face=&amp;quot;MS
Gothic&amp;quot;&gt;&lt;B&gt;" & objRS(i).Name & "&lt;/B&gt;&lt;/font&gt;&lt;/td&gt;" 
<BR>&nbsp;&nbsp; Next 
<BR>
<BR>&nbsp;&nbsp; 'While not at the end of the records in the set...
<BR>&nbsp;&nbsp; While Not objRS.EOF
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Response.Write "&lt;/tr&gt;&lt;tr&gt;" 
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'For each column in the current row... 
<BR>&nbsp;&nbsp;&nbsp;&nbsp; For i = 0 to (objRS.Fields.Count - 1) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;write out the data in the field. 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %&gt;&lt;td&gt;&lt;font face="MS Gothic"&gt;&lt;%=objRS(i)%&gt;&lt;/font&gt;&lt;/td&gt;&lt;% 
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Next 
<BR>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'Move to the next row. 
<BR>&nbsp;&nbsp;&nbsp;&nbsp; objRS.MoveNext 
<BR>
<BR>&nbsp;&nbsp; Wend 
<BR>
<BR>&nbsp;&nbsp; Response.Write "&lt;/tr&gt;&lt;/table&gt;"
<BR>
<BR>&nbsp;&nbsp; 'Close the Connection.
<BR>&nbsp;&nbsp; objConn.Close
<BR>&nbsp; %&gt; 
<BR>
<BR>&nbsp; &lt;/font&gt; 
<BR>&nbsp; &lt;/body&gt; 
<BR>&nbsp; &lt;/html&gt; 
</p>
</code>

<P>
ブラウザには、次のように表示されます。
</P>

<p>
<font face="MS Gothic"> 
<h2>&nbsp; Display an Excel Spreadsheet in a Web Page</h2> 
<H4>&nbsp; Get Excel data in one string with the GetString method</H4>
<table border=1>
<tr>
<td>A2</td><td><font face="MS Gothic">B2</td><td><font face="MS Gothic">C2</font></td>
</tr><tr>
<td>A3</td><td><font face="MS Gothic">B3</td><td><font face="MS Gothic">C3</font></td>
</tr>
</table>
<H4>&nbsp; Get Excel data using MoveNext</H4>
<table border=1>
<tr>
<td><font face="MS Gothic"><B>A1</B></font></td><td><font face="MS Gothic"><B>B1</B></font></td><td><font face="MS Gothic"><B>C1</B></font></td>
</tr><tr>
<td><font face="MS Gothic">A2</font></td><td><font face="MS Gothic">B2</font></td><td><font face="MS Gothic">C2</font></td>
</tr><tr>
<td><font face="MS Gothic">A3</font></td><td><font face="MS Gothic">B3</font></td><td><font face="MS Gothic">C3</font></td>
</tr>
</table> 
</font> 

<BR><H2>次のトピック : ASP ページでの COM コンポーネントの使用</H2>

<hr class="iis" size="1">
<p align=center><A href="/iishelp/common/colegal.htm"><em>&copy; 1997-2001 Microsoft Corporation.All rights reserved.</em></A></p></font>
</body>
</html>
