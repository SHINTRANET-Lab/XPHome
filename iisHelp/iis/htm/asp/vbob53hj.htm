<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR=LTR>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=shift_jis">
<TITLE>QueryString</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> <SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="インターネット インフォメーション サービス リファレンス情報">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="JA">
<META NAME="MS-IT-LOC" Content="インターネット インフォメーション サービス"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H4><A NAME="_querystring"></A><SUP></SUP>QueryString</H4>

<P>QueryString コレクションは、HTTP クエリ文字列内の変数の値を取得します。HTTP クエリ文字列は、疑問符 (?) の後の値で指定されています。クエリ文字列を生成するプロセスにはさまざまなものがあります。たとえば、次のようなアンカー タグがあるとします。 </P>

<P>&lt;A HREF= "example?string=this is a sample"&gt;string sample&lt;/A&gt;</P>

<P>この場合、&quot;this is a sample&quot; という値を持つ <I>string</I> という名前の変数が生成されます。クエリ文字列は、フォームを送信したり、ユーザーがブラウザのアドレス ボックスにクエリを入力した場合にも生成されます。</P>

<H6>構文</H6>

<P>Request.<B>QueryString</B>(<I>variable</I>)[(<I>index</I>)|.Count] </P>

<P>&nbsp;</P>

<H6>パラメータ</H6>

<DL>
<DT><I>variable</I></DT>

<DD>HTTP クエリ文字列内にある、取得する変数の名前を指定します。<br>
</DD>

<DT><I>index</I></DT>

<DD><i>variable</i> の複数の値のうちの 1 つを取得できるようにするための省略可能なパラメータです。1 〜 Request.QueryString( <i>variable</i> ).Count の整数値を指定できます。</DD>
</DL>

<H6>解説</H6>

<P>QueryString コレクションは、ServerVariables コレクション内の変数 QUERY_STRING が解析されたものであり、QUERY_STRING の各変数を名前で参照することができます。Request.QueryString( <I>parameter</I> ) の値は、QUERY_STRING に出現するすべての <I>parameter</I> の値の配列になります。パラメータの値の数は、Request.QueryString(<I>parameter</I>).Count を呼び出して調べることができます。変数に関連付けられているデータ セットが複数でない場合は、個数は 1 になります。変数が見つからない場合には、個数は 0 になります。</P>

<P>複数のデータ セットのうちの 1 つにある QueryString 変数を参照するには、<I>index</I> の値を指定します。パラメータ <I>index</I> には 1 〜 Request.QueryString(<I>variable</I>).Count までの値を指定できます。<I>index</I> の値を指定せずに複数の QueryString 変数の 1 つを参照した場合、データはカンマで区切られた文字列として返されます。</P>

<P>Request.QueryString でパラメータを使用すると、サーバーはその要求に送られたパラメータを解析して、指定されたデータを返します。未解析の QueryString データがアプリケーションで必要な場合は、パラメータを指定せずに Request.QueryString を呼び出すことで取得できます。</P>

<P>ループを使用することで、クエリ文字列内のすべてのデータ値を解析できます。たとえば、次のような要求が送られたとします。</P>

<PRE><CODE>http://localhost/script/directory/NAMES.ASP?Q=Fred&amp;Q=Sally
 </CODE></PRE>

<P>そして、Names.asp に次のスクリプトが記述されているとします。</P>

<PRE><CODE>---NAMES.ASP---
&lt;%
  For Each item In Request.QueryString("Q")
    Response.Write Request.QueryString(item) &amp; "&lt;BR&gt;"
  Next
%&gt;
 </CODE></PRE>

<P>すると、Names.asp には、次のように表示されます。</P>

<PRE><CODE>Fred
Sally
 </CODE></PRE>

<P>上のスクリプトは、次のように Count を使用して記述することも可能です。</P>

<PRE><CODE>&lt;%
  For i = 1 To Request.QueryString("Q").Count   
    Response.Write Request.QueryString("Q")(i) &amp; "&lt;BR&gt;"
  Next
%&gt;
 </CODE></PRE>

<H6>例</H6>

<P>次のようなクライアント要求があるとします。</P>

<PRE><CODE>/scripts/directory-lookup.asp?name=fred&amp;age=22
 </CODE></PRE>

<P>QUERY_STRING の値は、次のようになります。 </P>

<PRE><CODE>name=fred&amp;age=22.
 </CODE></PRE>

<P>QueryString コレクションには、<CODE>name</CODE> および <CODE>age.</CODE> の 2 つのメンバが格納されます。ここで次のようなスクリプトを使います。 </P>

<PRE><CODE>Welcome,  &lt;%= Request.QueryString("name") %&gt;. 
Your age is  &lt;%= Request.QueryString("age") %&gt;.
 </CODE></PRE>

<P>すると、次のような出力が得られます。 </P>

<PRE><CODE>Welcome, Fred. Your age is 22.
 </CODE></PRE>

<P>次のようなスクリプトを使用したとします。</P>

<PRE><CODE>The unparsed query string is:  &lt;%=Request.QueryString %&gt;
 </CODE></PRE>

<P>すると、次のような出力が得られます。</P>

<PRE><CODE>The unparsed query string is: name=fred&amp;age=22
 </CODE></PRE>

<H6>対象</H6>

<P>Request オブジェクト</P>

<H6>関連項目</H6>

<P><A HREF="/iishelp/iis/htm/asp/vbob8q5h.htm"><B>ClientCertificate</B></A>、<A HREF="/iishelp/iis/htm/asp/vbob0z3o.htm"><B>Cookies</B></A>、<A HREF="/iishelp/iis/htm/asp/vbob4fl9.htm"><B>Form</B></A>、<A HREF="/iishelp/iis/htm/asp/vbob5vsj.htm"><B>ServerVariables</B></A></P>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation.All rights reserved.</a></em></p>
</BODY>
</HTML>
